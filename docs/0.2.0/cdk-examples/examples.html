<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at May 2, 2013
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20130502" />
    <meta http-equiv="Content-Language" content="en" />
    <title>CDK Examples Module - </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/cloudera/cdk">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>CDK Examples Module</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2013-05-02</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 0.2.0</li>
                      
                
            
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
            
                <ul class="nav nav-list">
                    <li class="nav-header">CDK</li>
                                
      <li>
    
                          <a href="../index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li>
    
                          <a href="http://github.com/cloudera/cdk" class="externalLink" title="Source Repository">
          <i class="none"></i>
        Source Repository</a>
            </li>
                  
      <li>
    
                          <a href="https://issues.cloudera.org/browse/CDK" class="externalLink" title="JIRA">
          <i class="none"></i>
        JIRA</a>
            </li>
                  
      <li>
    
                          <a href="../how_to_contribute.html" title="How To Contribute">
          <i class="none"></i>
        How To Contribute</a>
            </li>
                  
      <li>
    
                          <a href="../adding_a_module.html" title="Adding a Module">
          <i class="none"></i>
        Adding a Module</a>
            </li>
                                        <li class="nav-header">Examples Module</li>
                                
      <li class="active">
    
            <a href="#"><i class="none"></i>Usage Examples</a>
          </li>
                  
      <li>
    
                          <a href="apidocs/index.html" title="Javadoc">
          <i class="none"></i>
        Javadoc</a>
            </li>
                              <li class="nav-header">Reports</li>
                                                                                                                                                                            
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                    
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
            
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <h1>Cloudera Development Kit - Examples Module</h1><p>The Examples Module is a collection of examples for the CDK.</p><div class="section"><h2>Example - User Dataset<a name="Example_-_User_Dataset"></a></h2><p>This example shows basic usage of the CDK Data API for performing streaming writes to (and reads from) a dataset.</p><p>From the examples module, build with:</p>
<div class="source"><pre class="prettyprint">mvn compile
</pre></div><p>Then create the dataset with:</p>
<div class="source"><pre class="prettyprint">mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.CreateUserDatasetPojo&quot;
</pre></div><p>You can look at the files that were created with:</p>
<div class="source"><pre class="prettyprint">find /tmp/data
</pre></div><p>Read the entities in the dataset:</p>
<div class="source"><pre class="prettyprint">mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.ReadUserDatasetPojo&quot;
</pre></div><p>Finally, drop the dataset:</p>
<div class="source"><pre class="prettyprint">mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.DropUserDataset&quot;
</pre></div><div class="section"><h3>Generic records vs. POJOs<a name="Generic_records_vs._POJOs"></a></h3><p>The previous examples used POJOs, since they are the most familiar data transfer obejcts for most Java programmers. Avro supports generic records too, which are more efficient, since they dont require reflection, and also dont require either the reader or writer to have the POJO class available.</p><p>Run the following to use the generic writer and reader:</p>
<div class="source"><pre class="prettyprint">mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.CreateUserDatasetGeneric&quot;
mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.ReadUserDatasetGeneric&quot;
mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.DropUserDataset&quot;
</pre></div></div><div class="section"><h3>Partitioning<a name="Partitioning"></a></h3><p>The API supports partitioning, so that records are written to different partition files according to the value of particular partition fields.</p>
<div class="source"><pre class="prettyprint">mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.CreateUserDatasetGenericPartitioned&quot;
find /tmp/data # see how partitioning affects the data layout
mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.ReadUserDatasetGeneric&quot;
mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.ReadUserDatasetGenericOnePartition&quot;
mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.DropUserDataset&quot;
</pre></div></div><div class="section"><h3>Parquet Columar Format<a name="Parquet_Columar_Format"></a></h3><p>Parquet is a new columnar format for data. Columnar formats provide performance advantages over row-oriented formats like Avro data files (which is the default in CDK), when the number of columns is large (dozens) and the typical queries that you perform over the data only retrieve a small number of the columns.</p><p>Note that Parquet support is still experimental in this release.</p>
<div class="source"><pre class="prettyprint">mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.CreateUserDatasetGenericParquet&quot;
find /tmp/data # see the parquet file extension
mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.ReadUserDatasetGeneric&quot;
mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.DropUserDataset&quot;
</pre></div></div><div class="section"><h3>HCatalog<a name="HCatalog"></a></h3><p>So far all metadata has been stored in the <i>.metadata</i> directory on the filesystem. Its possible to store metadata in HCatalog so that other HCatalog-aware applications like Hive can make use of it.</p><p>Run the following to create the dataset:</p>
<div class="source"><pre class="prettyprint">mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.CreateHCatalogUserDatasetGeneric&quot;
</pre></div><p>Hive/HCatalogs metastore directory is set to <i>/tmp/user/hive/warehouse/</i> (see <i>resources/hive-site.xml</i>), which is where the data is written to:</p>
<div class="source"><pre class="prettyprint">find /tmp/user/hive/warehouse/
</pre></div><p>Notice that there is no metadata stored there, since the metadata is stored in Hive/HCatalogs metastore:</p>
<div class="source"><pre class="prettyprint">hive -e 'describe users'
</pre></div><p>You can use Hive to query the data directly:</p>
<div class="source"><pre class="prettyprint">hive -e 'select * from users'
</pre></div><p>Alternatively, you can use the Java API to read the data:</p>
<div class="source"><pre class="prettyprint">mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.ReadHCatalogUserDatasetGeneric&quot;
</pre></div><p>Dropping the dataset deletes the metadata from the metastore and the data from the filesystem:</p>
<div class="source"><pre class="prettyprint">mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.DropHCatalogUserDataset&quot;
</pre></div></div></div><div class="section"><h2>Scala<a name="Scala"></a></h2><p>Run the equivalent example with:</p>
<div class="source"><pre class="prettyprint">scala -cp &quot;$(mvn dependency:build-classpath | grep -v '^\[')&quot; src/main/scala/createpojo.scala
</pre></div><p>Or for the generic example:</p>
<div class="source"><pre class="prettyprint">scala -cp &quot;$(mvn dependency:build-classpath | grep -v '^\[')&quot; src/main/scala/creategeneric.scala
</pre></div><p>The Java examples can be used to read (and drop) the dataset written from Scala:</p>
<div class="source"><pre class="prettyprint">mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.ReadUserDatasetGeneric&quot;
mvn exec:java -Dexec.mainClass=&quot;com.cloudera.cdk.examples.data.DropUserDataset&quot;
</pre></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2013
                        <a href="http://www.cloudera.com">Cloudera</a>.
            All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
