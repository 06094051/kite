<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2015-02-11
 Rendered using Blank Maven Skin 1.0.0 (http://github.com/andriusvelykis/blank-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Usage</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />
		<link rel="stylesheet" href="./css/site.css" />

	</head>

	<body>

<h1>Usage</h1>
<div class="section">
<h2>Working with datasets<a name="Working_with_datasets"></a></h2>
<p>The <tt>kite:create-dataset</tt> and <tt>kite:delete-dataset</tt> goals are for creating and deleting datasets. Configure the Hadoop settings by declaring the plugin in your POM:</p>

<div class="source">
<pre>&lt;project&gt;
  ...
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.kitesdk&lt;/groupId&gt;
        &lt;artifactId&gt;kite-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;0.18.0&lt;/version&gt;
        &lt;configuration&gt;
          &lt;hadoopConfiguration&gt;
            &lt;property&gt;
              &lt;name&gt;fs.default.name&lt;/name&gt;
              &lt;value&gt;hdfs://localhost&lt;/value&gt;
            &lt;/property&gt;
            &lt;property&gt;
              &lt;name&gt;hive.metastore.uris&lt;/name&gt;
              &lt;value&gt;thrift://localhost:9083&lt;/value&gt;
            &lt;/property&gt;
          &lt;/hadoopConfiguration&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
   ...
&lt;/project&gt;
</pre></div>
<p>If you are using the default settings (local file system and local Hive metastore) then you can omit the <tt>configuration</tt> element.</p>
<p>To create a new dataset, run:</p>

<div class="source">
<pre>mvn kite:create-dataset \
  -Dkite.rootDirectory=/tmp/data \
  -Dkite.datasetName=mydataset \
  -Dkite.avroSchemaFile=myschema.avsc
</pre></div>
<p>The <tt>avroSchemaFile</tt> property specifies a local file.</p>
<p>To delete a dataset, run:</p>

<div class="source">
<pre>mvn kite:delete-dataset \
  -Dkite.rootDirectory=/tmp/data \
  -Dkite.datasetName=mydataset
</pre></div></div>
<div class="section">
<h2>Launching jobs locally with kite:run-tool<a name="Launching_jobs_locally_with_kite:run-tool"></a></h2>
<p>This goal is used to run a Hadoop Tool. The Tool&#x2019;s <tt>run()</tt> method is executed in the same local VM as Maven, however it is common for the Tool to launch distributed processes, such as MapReduce jobs which run on a cluster.</p>

<div class="source">
<pre>&lt;project&gt;
  ...
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.kitesdk&lt;/groupId&gt;
        &lt;artifactId&gt;kite-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;0.18.0&lt;/version&gt;
        &lt;configuration&gt;
          &lt;toolClass&gt;org.example.ToolImplementation&lt;/toolClass&gt;
          &lt;!-- optional --&gt;
          &lt;args&gt;
            &lt;arg&gt;arg1&lt;/arg&gt;
            &lt;arg&gt;arg2&lt;/arg&gt;
          &lt;/args&gt;
          &lt;hadoopConfiguration&gt;
            &lt;property&gt;
              &lt;name&gt;fs.default.name&lt;/name&gt;
              &lt;value&gt;hdfs://localhost&lt;/value&gt;
            &lt;/property&gt;
            &lt;property&gt;
              &lt;name&gt;mapred.job.tracker&lt;/name&gt;
              &lt;value&gt;localhost:8021&lt;/value&gt;
            &lt;/property&gt;
          &lt;/hadoopConfiguration&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
   ...
&lt;/project&gt;
</pre></div>
<p>Run the tool using:</p>

<div class="source">
<pre>mvn kite:run-tool
</pre></div>
<div class="section">
<h3>Understanding the classpath<a name="Understanding_the_classpath"></a></h3>
<p>The classpath for the local VM is made up of the <i>runtime</i> classpath (all dependencies in the <i>compile</i> and <i>runtime</i> scopes). Hadoop libraries are provided by the plugin, so there is no need to include Hadoop in the <i>compile</i> and <i>runtime</i> scopes (and indeed doing so may cause undefined behaviour).</p>
<p>The classpath for distributed processes is made up of the <i>runtime</i> classpath , unless <tt>kite.addDependenciesToDistributedCache</tt> is set to <tt>false</tt> (the default is <tt>true</tt>), in which case no dependencies are included in the distributed classpath.</p>
<p>This makes it very convenient to run distributed jobs, since all runtime dependencies are automatically included in the Tool classpath and the MapReduce task classpath.</p></div></div>
<div class="section">
<h2>Launching jobs from the cluster<a name="Launching_jobs_from_the_cluster"></a></h2>
<p>There are three goals for building and running jobs on the cluster:</p>

<ul>
  
<li><tt>kite:package-app</tt> builds a packaged application locally (in the Oozie package format)</li>
  
<li><tt>kite:deploy-app</tt> deploys the packaged application to the cluster</li>
  
<li><tt>kite:run-app</tt> runs the deployed application as an Oozie job</li>
</ul>
<p>A packaged application includes an Oozie workflow file, an Oozie coordinator file (optional), and the dependencies on the <i>runtime</i> classpath. The workflow file may be generated from the plugin configuration. The following example shows how to run the previous example from the cluster, by adding properties for <tt>deployFileSystem</tt> and <tt>oozieUrl</tt>, and a <tt>executions</tt> section to bind <tt>kite-package</tt> to the <tt>package</tt> phase of the Maven lifecycle.</p>

<div class="source">
<pre>&lt;project&gt;
  ...
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.kitesdk&lt;/groupId&gt;
        &lt;artifactId&gt;kite-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;0.18.0&lt;/version&gt;
        &lt;configuration&gt;
          &lt;toolClass&gt;org.example.ToolImplementation&lt;/toolClass&gt;
          &lt;deployFileSystem&gt;hdfs://localhost/&lt;/deployFileSystem&gt;
          &lt;oozieUrl&gt;http://localhost:11000/oozie&lt;/oozieUrl&gt;
          &lt;!-- optional --&gt;
          &lt;args&gt;
            &lt;arg&gt;arg1&lt;/arg&gt;
            &lt;arg&gt;arg2&lt;/arg&gt;
          &lt;/args&gt;
          &lt;hadoopConfiguration&gt;
            &lt;property&gt;
              &lt;name&gt;fs.default.name&lt;/name&gt;
              &lt;value&gt;hdfs://localhost&lt;/value&gt;
            &lt;/property&gt;
            &lt;property&gt;
              &lt;name&gt;mapred.job.tracker&lt;/name&gt;
              &lt;value&gt;localhost:8021&lt;/value&gt;
            &lt;/property&gt;
          &lt;/hadoopConfiguration&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;id&gt;make-app&lt;/id&gt;
            &lt;phase&gt;package&lt;/phase&gt;
            &lt;goals&gt;
              &lt;goal&gt;package-app&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
   ...
&lt;/project&gt;
</pre></div>
<p>Build and run with:</p>

<div class="source">
<pre>mvn package kite:deploy-app
mvn kite:run-app
</pre></div></div>


	</body>
</html>
