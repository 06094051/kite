<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2013-08-01
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20130801" />
    <meta http-equiv="Content-Language" content="en" />
    <title>CDK Morphlines Parent - </title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/cloudera/cdk">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>CDK Morphlines Parent</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2013-08-01</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 0.5.0</li>
                      
                
                    
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">CDK</li>
                                
      <li>
    
                          <a href="../index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li>
    
                          <a href="../release_notes.html" title="Release Notes">
          <i class="none"></i>
        Release Notes</a>
            </li>
                  
      <li>
    
                          <a href="../apidocs/index.html" title="Javadoc">
          <i class="none"></i>
        Javadoc</a>
            </li>
                  
      <li>
    
                          <a href="../jdiff/changes.html" title="API Diffs">
          <i class="none"></i>
        API Diffs</a>
            </li>
                  
      <li>
    
                          <a href="../dependencies.html" title="Dependency Information">
          <i class="none"></i>
        Dependency Information</a>
            </li>
                  
      <li>
    
                          <a href="http://github.com/cloudera/cdk-examples" class="externalLink" title="Examples">
          <i class="none"></i>
        Examples</a>
            </li>
                  
      <li>
    
                          <a href="http://github.com/cloudera/cdk" class="externalLink" title="Source Repository">
          <i class="none"></i>
        Source Repository</a>
            </li>
                  
      <li>
    
                          <a href="https://issues.cloudera.org/browse/CDK" class="externalLink" title="JIRA">
          <i class="none"></i>
        JIRA</a>
            </li>
                  
      <li>
    
                          <a href="../how_to_contribute.html" title="How To Contribute">
          <i class="none"></i>
        How To Contribute</a>
            </li>
                  
      <li>
    
                          <a href="../adding_a_module.html" title="Adding a Module">
          <i class="none"></i>
        Adding a Module</a>
            </li>
                  
      <li>
    
                          <a href="../project-info.html" title="Project Information">
          <i class="none"></i>
        Project Information</a>
            </li>
                              <li class="nav-header">Modules</li>
                                
      <li>
    
                          <a href="../cdk-data/index.html" title="CDK Data">
          <i class="none"></i>
        CDK Data</a>
            </li>
                  
      <li>
    
                          <a href="../cdk-maven-plugin/index.html" title="CDK Maven Plugin">
          <i class="none"></i>
        CDK Maven Plugin</a>
            </li>
                  
      <li>
    
                          <a href="../cdk-morphlines/index.html" title="CDK Morphlines">
          <i class="none"></i>
        CDK Morphlines</a>
            </li>
                  
      <li>
    
                          <a href="../cdk-tools/index.html" title="CDK Tools">
          <i class="none"></i>
        CDK Tools</a>
            </li>
                              <li class="nav-header">CDK Morphlines</li>
                                
      <li>
    
                          <a href="index.html" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li class="active">
    
            <a href="#"><i class="none"></i>Morphlines Reference Guide</a>
          </li>
            </ul>
                
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section">
<h2>Cloudera Morphlines Reference Guide - Table of Contents<a name="Cloudera_Morphlines_Reference_Guide_-_Table_of_Contents"></a></h2></div>
<p>Cloudera Morphlines provides a set of frequently-used high-level transformation and I/O commands that can be combined in application specific ways. This chapter outlines the currently available commands.</p>
<div class="section">
<h4>cdk-morphlines-core-stdio<a name="cdk-morphlines-core-stdio"></a></h4></div>
<ul>
<li><a href="#readClob">readClob</a></li>
<li><a href="#readCSV">readCSV</a></li>
<li><a href="#readLine">readLine</a></li>
<li><a href="#readMultiLine">readMultiLine</a></li></ul>
<div class="section">
<h4>cdk-morphlines-core-stdlib<a name="cdk-morphlines-core-stdlib"></a></h4></div>
<ul>
<li><a href="#addCurrentTime">addCurrentTime</a></li>
<li><a href="#addLocalHost">addLocalHost</a></li>
<li><a href="#addValues">addValues</a></li>
<li><a href="#addValuesIfAbsent">addValuesIfAbsent</a></li>
<li><a href="#callParentPipe">callParentPipe</a></li>
<li><a href="#contains">contains</a></li>
<li><a href="#convertTimestamp">convertTimestamp</a></li>
<li><a href="#decodeBase64">decodeBase64</a></li>
<li><a href="#dropRecord">dropRecord</a></li>
<li><a href="#equals">equals</a></li>
<li><a href="#extractURIComponents">extractURIComponents</a></li>
<li><a href="#extractURIQueryParameters">extractURIQueryParameters</a></li>
<li><a href="#findReplace">findReplace</a></li>
<li><a href="#generateUUID">generateUUID</a></li>
<li><a href="#grok">grok</a></li>
<li><a href="#if">if</a></li>
<li><a href="#java">java</a></li>
<li><a href="#logTrace">logTrace, logDebug, logInfo, logWarn, logError</a></li>
<li><a href="#not">not</a></li>
<li><a href="#pipe">pipe</a></li>
<li><a href="#separateAttachments">separateAttachments</a></li>
<li><a href="#setValues">setValues</a></li>
<li><a href="#split">split</a></li>
<li><a href="#toString">toString</a></li>
<li><a href="#translate">translate</a></li>
<li><a href="#tryRules">tryRules</a></li></ul>
<div class="section">
<h4>cdk-morphlines-avro<a name="cdk-morphlines-avro"></a></h4></div>
<ul>
<li><a href="#readAvroContainer">readAvroContainer</a></li>
<li><a href="#readAvro">readAvro</a></li>
<li><a href="#extractAvroTree">extractAvroTree</a></li>
<li><a href="#extractAvroPaths">extractAvroPaths</a></li></ul>
<div class="section">
<h4>cdk-morphlines-json<a name="cdk-morphlines-json"></a></h4></div>
<ul>
<li><a href="#readJson">readJson</a></li>
<li><a href="#extractJsonPaths">extractJsonPaths</a></li></ul>
<div class="section">
<h4>cdk-morphlines-hadoop-sequencefile<a name="cdk-morphlines-hadoop-sequencefile"></a></h4></div>
<ul>
<li><a href="#readSequenceFile">readSequenceFile</a></li></ul>
<div class="section">
<h4>cdk-morphlines-tika-core<a name="cdk-morphlines-tika-core"></a></h4></div>
<ul>
<li><a href="#detectMimeType">detectMimeType</a></li></ul>
<div class="section">
<h4>cdk-morphlines-tika-decompress<a name="cdk-morphlines-tika-decompress"></a></h4></div>
<ul>
<li><a href="#decompress">decompress</a></li>
<li><a href="#unpack">unpack</a></li></ul>
<div class="section">
<h4>cdk-morphlines-saxon<a name="cdk-morphlines-saxon"></a></h4></div>
<ul>
<li><a href="#convertHTML">convertHTML</a></li>
<li><a href="#xquery">xquery</a></li>
<li><a href="#xslt">xslt</a></li></ul>
<div class="section">
<h4>cdk-morphlines-solr-core<a name="cdk-morphlines-solr-core"></a></h4></div>
<ul>
<li><a href="#solrLocator">solrLocator</a></li>
<li><a href="#loadSolr">loadSolr</a></li>
<li><a href="#generateSolrSequenceKey">generateSolrSequenceKey</a></li>
<li><a href="#sanitizeUnknownSolrFields">sanitizeUnknownSolrFields</a></li>
<li><a href="#tokenizeText">tokenizeText</a></li></ul>
<div class="section">
<h4>cdk-morphlines-solr-cell<a name="cdk-morphlines-solr-cell"></a></h4></div>
<ul>
<li><a href="#solrCell">solrCell</a></li></ul>
<div class="section">
<h2>Introduction<a name="Introduction"></a></h2></div>
<p>Cloudera Morphlines provides a set of frequently-used high-level transformation and I/O commands that can be combined in application specific ways. This chapter outlines the currently available commands.</p>
<p>Note that perhaps the most important property of the Morphlines framework is how easy it is to add new transformations and I/O commands and integrate existing functionality and third party systems. If none of the existing commands match your use case, you can easily write your own command and plug it in. Simply implement the Java interface <tt>Command</tt> or subclass <tt>AbstractCommand</tt> and add the resulting Java class to the classpath. No registration or other administrative action is required. Here are links to two sample command implementations: <br /> <br /></p>
<ul>
<li><a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ToStringBuilder.java">toString</a> <br /></li>
<li><a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdio/ReadLineBuilder.java">readLine</a> <br /> <br /> Indeed, none of the standard commands are special or intrinsically known per se. All commands are implemented like this, even including standard commands such as <tt>pipe</tt>, <tt>if</tt>, and <tt>tryRules</tt>. This means your custom commands can even replace any standard commands, if desired.</li></ul>
<div class="section">
<h2>cdk-morphlines-core-stdio<a name="cdk-morphlines-core-stdio"></a></h2></div>
<p>This module contains standard I/O commands for tasks such as acting on single-line records, multi-line records, CSV files, and for converting bytes to strings.</p>
<div class="section">
<h3>readClob<a name="readClob"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdio/ReadClobBuilder.java">readClob</a> command converts bytes to strings. It emits one record for the entire input stream of the first attachment, interpreting the stream as a Character Large Object (CLOB). The line is put as a string into the <tt>message</tt> output field.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> supportedMimeTypes </td>
<td> null </td>
<td> Optionally, require the input record to match one of the MIME types in this list. </td></tr>
<tr class="a">
<td> charset </td>
<td> null </td>
<td> The character encoding to use, for example, UTF-8. If none is specified the charset specified in the _attachment_charset input field is used instead. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>readClob {
  charset : UTF-8
}
</pre></div>
<div class="section">
<h3>readCSV<a name="readCSV"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdio/ReadCSVBuilder.java">readCSV</a> command extracts zero or more records from the input stream of the first attachment of the record, representing a Comma Separated Values (CSV) file.</p>
<p>For the format see this <a class="externalLink" href="http://www.creativyst.com/Doc/Articles/CSV/CSV01.htm">article</a>.</p>
<p>Some CSV files contain a header line that contains embedded column names. This command does not support reading and using such embedded column names as output field names because this is considered unreliable for production systems. If the first line of the CSV file is a header line, you must set the <tt>ignoreFirstLine</tt> option to true. You must explicitly define the <tt>columns</tt> configuration parameter in order to name the output fields.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> supportedMimeTypes </td>
<td> null </td>
<td> Optionally, require the input record to match one of the MIME types in this list. </td></tr>
<tr class="a">
<td> separator </td>
<td> &quot;,&quot; </td>
<td> The character separating any two fields. </td></tr>
<tr class="b">
<td> columns </td>
<td> n/a </td>
<td> The name of the output fields for each input column. An empty string indicates omit this column in the output. If more columns are contained in the input than specified here, those columns are automatically named <tt>columnN</tt>. </td></tr>
<tr class="a">
<td> ignoreFirstLine </td>
<td> false </td>
<td> Whether to ignore the first line. This flag can be used for CSV files that contain a header line. </td></tr>
<tr class="b">
<td> trim </td>
<td> true </td>
<td> Whether leading and trailing whitespace shall be removed from the output fields. </td></tr>
<tr class="a">
<td> charset </td>
<td> null </td>
<td> The character encoding to use, for example, UTF-8. If none is specified the charset specified in the _attachment_charset input field is used instead. </td></tr>
<tr class="b">
<td> quoteChar </td>
<td> &quot;&quot; </td>
<td> Must be a string of length zero or one. If this parameter is a String containing a single character then a quoted field can span multiple lines in the input stream. To disable quoting and multiline fields set this parameter to the empty string <tt>&quot;&quot;</tt>. </td></tr>
<tr class="a">
<td> commentPrefix </td>
<td> &quot;&quot; </td>
<td> Must be a string of length zero or one, for example &quot;#&quot;. If this parameter is a String containing a single character then lines starting with that character are ignored as comments. To disable the comment line feature set this parameter to the empty string <tt>&quot;&quot;</tt>. </td></tr></table>
<p>If the parameter <tt>quoteChar</tt> is a String containing a single character then a quoted field can span multiple lines in the input stream, for example as shown in the following example CSV input containing a single record with three columns:</p>
<div class="source">
<pre>column0,&quot;Look, new hot tub under redwood tree!
All bubbly!&quot;,column2
</pre></div>
<p>The above example can be parsed by specifying a double-quote character for the parameter <tt>quoteChar</tt>, using backslash syntax per the <a class="externalLink" href="http://www.json.org">JSON specification</a>, as follows:</p>
<div class="source">
<pre>readCSV {
  ...
  quoteChar : &quot;\&quot;&quot;
</pre></div>
<p>If the parameter <tt>commentPrefix</tt> is a String containing a single character then lines starting with that character are ignored as comments. Example:</p>
<div class="source">
<pre>#This is a comment line. It is ignored.
</pre></div>
<p>Example usage for CSV (Comma Separated Values):</p>
<div class="source">
<pre>readCSV {
  separator : &quot;,&quot;
  columns : [Age,&quot;&quot;,Extras,Type]
  ignoreFirstLine : false
  quoteChar : &quot;&quot;
  commentPrefix : &quot;&quot;
  trim : true
  charset : UTF-8
}
</pre></div>
<p>Example usage for TSV (Tab Separated Values):</p>
<div class="source">
<pre>readCSV {
  separator : &quot;\t&quot;
  columns : [Age,&quot;&quot;,Extras,Type]
  ignoreFirstLine : false
  quoteChar : &quot;&quot;
  commentPrefix : &quot;&quot;
  trim : true
  charset : UTF-8
}
</pre></div>
<p>Example usage for SSV (Space Separated Values):</p>
<div class="source">
<pre>readCSV {
  separator : &quot; &quot;
  columns : [Age,&quot;&quot;,Extras,Type]
  ignoreFirstLine : false
  quoteChar : &quot;&quot;
  commentPrefix : &quot;&quot;
  trim : true
  charset : UTF-8
}
</pre></div>
<p>Example usage for Apache Hive (Values separated by non-printable CTRL-A character):</p>
<div class="source">
<pre>readCSV {
  separator : &quot;\u0001&quot;
  columns : [Age,&quot;&quot;,Extras,Type]
  ignoreFirstLine : false
  quoteChar : &quot;&quot;
  commentPrefix : &quot;&quot;
  trim : false
  charset : UTF-8
}
</pre></div>
<div class="section">
<h3>readLine<a name="readLine"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdio/ReadLineBuilder.java">readLine</a> command emits one record per line in the input stream of the first attachment. The line is put as a string into the <tt>message</tt> output field. Empty lines are ignored.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> supportedMimeTypes </td>
<td> null </td>
<td> Optionally, require the input record to match one of the MIME types in this list. </td></tr>
<tr class="a">
<td> ignoreFirstLine </td>
<td> false </td>
<td> Whether to ignore the first line. This flag can be used for CSV files that contain a header line. </td></tr>
<tr class="b">
<td> commentPrefix </td>
<td> &quot;&quot; </td>
<td> A character that indicates to ignore this line as a comment <s></s> for example, &quot;#&quot;. To disable the comment line feature set this parameter to the empty string <tt>&quot;&quot;</tt>. </td></tr>
<tr class="a">
<td> charset </td>
<td> null </td>
<td> The character encoding to use, for example, UTF-8. If none is specified the charset specified in the _attachment_charset input field is used instead. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>readLine {
  ignoreFirstLine : true
  commentPrefix : &quot;#&quot;
  charset : UTF-8
}
</pre></div>
<div class="section">
<h3>readMultiLine<a name="readMultiLine"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdio/ReadMultiLineBuilder.java">readMultiLine</a> command is a multiline log parser that collapse multiline messages into a single record. It supports <tt>regex</tt>, <tt>what</tt>, and <tt>negate</tt> configuration parameters similar to logstash. The line is put as a string into the <tt>message</tt> output field.</p>
<p>For example, this can be used to parse log4j with stack traces. Also see <a class="externalLink" href="https://gist.github.com/smougenot/3182192">https://gist.github.com/smougenot/3182192</a> and <a class="externalLink" href="http://logstash.net/docs/1.1.13/filters/multiline">http://logstash.net/docs/1.1.13/filters/multiline</a>.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> supportedMimeTypes </td>
<td> null </td>
<td> Optionally, require the input record to match one of the MIME types in this list. </td></tr>
<tr class="a">
<td> regex </td>
<td> n/a </td>
<td> This parameter should match what you believe to be an indicator that the line is part of a multi-line record. </td></tr>
<tr class="b">
<td> what </td>
<td> previous </td>
<td> This parameter must be one of &quot;previous&quot; or &quot;next&quot; and indicates the relation of the regex to the multi-line record. </td></tr>
<tr class="a">
<td> negate </td>
<td> false </td>
<td> This parameter can be true or false. If true, a line not matching the regex constitutes a match of the multiline filter and the previous or next action is applied. The reverse is also true. </td></tr>
<tr class="b">
<td> charset </td>
<td> null </td>
<td> The character encoding to use, for example, UTF-8. If none is specified the charset specified in the _attachment_charset input field is used instead. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre># parse log4j with stack traces
readMultiLine {
  regex : &quot;(^.+Exception: .+)|(^\\s+at .+)|(^\\s+\\.\\.\\. \\d+ more)|(^\\s*Caused by:.+)&quot;
  what : previous
  charset : UTF-8
}

# parse sessions; begin new record when we find a line that starts with &quot;Started session&quot;
readMultiLine {
  regex : &quot;Started session.*&quot;
  what : next
  charset : UTF-8
}

</pre></div>
<div class="section">
<h2>cdk-morphlines-core-stdlib<a name="cdk-morphlines-core-stdlib"></a></h2></div>
<p>This module contains standard transformation commands, such as commands for flexible log file analysis, regular expression based pattern matching and extraction, operations on fields for assignment and comparison, operations on fields with list and set semantics, if-then-else conditionals, string and timestamp conversions, scripting support for dynamic java code, a small rules engine, logging, and metrics and counters.</p>
<div class="section">
<h3>addCurrentTime<a name="addCurrentTime"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/AddCurrentTimeBuilder.java">addCurrentTime</a> command adds the result of <a class="externalLink" href="http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#currentTimeMillis()">System.currentTimeMillis()</a> as a Long integer to a given output field. Typically, a <tt>convertTimestamp</tt> command is subsequently used to convert this timestamp to an application specific output format.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> field </td>
<td> timestamp </td>
<td> The name of the field to set. </td></tr>
<tr class="a">
<td> preserveExisting </td>
<td> true </td>
<td> Whether to preserve the field value if one is already present. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>addCurrentTime {}
</pre></div>
<div class="section">
<h3>addLocalHost<a name="addLocalHost"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/AddLocalHostBuilder.java">addLocalHost</a> command adds the name or IP of the local host to a given output field.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> field </td>
<td> host </td>
<td> The name of the field to set. </td></tr>
<tr class="a">
<td> preserveExisting </td>
<td> true </td>
<td> Whether to preserve the field value if one is already present. </td></tr>
<tr class="b">
<td> useIP </td>
<td> true </td>
<td> Whether to add the IP address or fully-qualified hostname. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>addLocalHost {
  field : my_host
  useIP : false
}
</pre></div>
<div class="section">
<h3>addValues<a name="addValues"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/AddValuesBuilder.java">addValues</a> command takes a set of <tt>outputField : values</tt> pairs and performs the following steps: For each output field, adds the given values to the field. The command can fetch the values of a record field using a <i>field expression</i>, which is a string of the form @{fieldname}.</p>
<p>Example usage:</p>
<div class="source">
<pre>addValues {
  # add values &quot;text/log&quot; and &quot;text/log2&quot; to the source_type output field
  source_type : [text/log, text/log2]

  # add integer 123 to the pid field
  pid : [123]

  # add all values contained in the first_name field to the name field
  name : &quot;@{first_name}&quot;
}
</pre></div>
<div class="section">
<h3>addValuesIfAbsent<a name="addValuesIfAbsent"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/AddValuesIfAbsentBuilder.java">addValuesIfAbsent</a> command is the same as the <tt>addValues</tt> command, except that a given value is only added to the output field if it is not already contained in the output field.</p>
<p>Example usage:</p>
<div class="source">
<pre>addValuesIfAbsent {
  # add values &quot;text/log&quot; and &quot;text/log2&quot; to the source_type output field
  # unless already present
  source_type : [text/log, text/log2]

  # add integer 123 to the pid field, unless already present
  pid : [123]

  # add all values contained in the first_name field to the name field
  # unless already present
  name : &quot;@{first_name}&quot;
}
</pre></div>
<div class="section">
<h3>callParentPipe<a name="callParentPipe"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/CallParentPipeBuilder.java">callParentPipe</a> command routes records to the enclosing pipe object. Recall that a morphline <i>is a</i> pipe. Thus, unless a morphline contains nested pipes, the parent pipe of a given command is the morphline itself, meaning that the first command of the morphline is called with the given record. Thus, the <tt>callParentPipe</tt> command effectively implements recursion, which is useful for extracting data from container file formats in elegant and concise ways. For example, you could use this to extract data from tar.gz files. This command is typically used in combination with the commands <tt>detectMimeType</tt>, <tt>tryRules</tt>, <tt>decompress</tt>, <tt>unpack</tt>, and possibly <tt>solrCell</tt>.</p>
<p>Example usage:</p>
<div class="source">
<pre>callParentPipe {}
</pre></div>
<p>For a real world example, see the <tt>solrCell</tt> command.</p>
<div class="section">
<h3>contains<a name="contains"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ContainsBuilder.java">contains</a> command succeeds if one of the field values of the given named field is equal to one of the the given values, and fails otherwise. Multiple fields can be named, in which case the results are ANDed.</p>
<p>Example usage:</p>
<div class="source">
<pre># succeed if the _attachment_mimetype field contains a value &quot;avro/binary&quot;
# fail otherwise
contains { _attachment_mimetype : [avro/binary] }

# succeed if the tags field contains a value &quot;version1&quot; or &quot;version2&quot;,
# fail otherwise
contains { tags : [version1, version2] }
</pre></div>
<div class="section">
<h3>convertTimestamp<a name="convertTimestamp"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ConvertTimestampBuilder.java">convertTimestamp</a> command converts the timestamps in a given field from one of a set of input date formats (in an input timezone) to an output date format (in an output timezone), while respecting daylight savings time rules. The command provides reasonable defaults for common use cases.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> field </td>
<td> timestamp </td>
<td> The name of the field to convert. </td></tr>
<tr class="a">
<td> inputFormats </td>
<td> A list of common input date formats </td>
<td> A list of <a class="externalLink" href="http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html">SimpleDateFormat</a> or &quot;unixTimeInMillis&quot; or &quot;unixTimeInSeconds&quot;. &quot;unixTimeInMillis&quot; and &quot;unixTimeInSeconds&quot; indicate the difference, measured in milliseconds and seconds, respectively, between a timestamp and midnight, January 1, 1970 UTC. Multiple input date formats can be specified. If none of the input formats match the field value then the command fails.</td></tr>
<tr class="b">
<td> inputTimezone </td>
<td> UTC </td>
<td> The time zone to assume for the input timestamp. </td></tr>
<tr class="a">
<td> inputLocale </td>
<td> &quot;&quot; </td>
<td> The Java Locale to assume for the input timestamp. </td></tr>
<tr class="b">
<td> outputFormat </td>
<td> &quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot; </td>
<td> The <a class="externalLink" href="http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html">SimpleDateFormat</a> to which to convert. Can also be &quot;unixTimeInMillis&quot; or &quot;unixTimeInSeconds&quot;. &quot;unixTimeInMillis&quot; and &quot;unixTimeInSeconds&quot; indicate the difference, measured in milliseconds and seconds, respectively, between a timestamp and midnight, January 1, 1970 UTC. </td></tr>
<tr class="a">
<td> outputTimezone </td>
<td> UTC </td>
<td> The time zone to assume for the output timestamp. </td></tr>
<tr class="b">
<td> outputLocale </td>
<td> &quot;&quot; </td>
<td> The Java Locale to assume for the output timestamp. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre># convert the timestamp field to &quot;yyyy-MM-dd'T'HH:mm:ss.SSSZ&quot;
# The input may match one of &quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot;
# or &quot;yyyy-MM-dd'T'HH:mm:ss&quot; or &quot;yyyy-MM-dd&quot;.
convertTimestamp {
  field : timestamp
  inputFormats : [&quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot;, &quot;yyyy-MM-dd'T'HH:mm:ss&quot;, &quot;yyyy-MM-dd&quot;]
  inputTimezone : America/Los_Angeles
  outputFormat : &quot;yyyy-MM-dd'T'HH:mm:ss.SSS'Z'&quot;
  outputTimezone : UTC
}
</pre></div>
<div class="section">
<h3>decodeBase64<a name="decodeBase64"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/DecodeBase64Builder.java">decodeBase64</a> command converts a Base64 encoded String to a byte[] per Section 6.8. &quot;Base64 Content-Transfer-Encoding&quot; of <a class="externalLink" href="http://www.ietf.org/rfc/rfc2045.txt">RFC 2045</a>. The command converts each value in the given field and replaces it with the decoded value.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> field </td>
<td> n/a </td>
<td> The name of the field to modify. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>decodeBase64 { 
  field : screenshot_base64
}
</pre></div>
<div class="section">
<h3>dropRecord<a name="dropRecord"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/DropRecordBuilder.java">dropRecord</a> command silently consumes records without ever emitting any record. This is much like piping to <tt>/dev/null</tt>.</p>
<p>Example usage:</p>
<div class="source">
<pre>dropRecord {}
</pre></div>
<div class="section">
<h3>equals<a name="equals"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/EqualsBuilder.java">equals</a> command succeeds if all field values of the given named fields are equal to the the given values and fails otherwise. Multiple fields can be named, in which case a logical AND is applied to the results.</p>
<p>Example usage:</p>
<div class="source">
<pre># succeed if the _attachment_mimetype field contains the value &quot;avro/binary&quot;
# and nothing else, fail otherwise
equals { _attachment_mimetype : [avro/binary] }

# succeed if the tags field contains nothing but the values &quot;version1&quot;
# and &quot;highPriority&quot;, in that order, fail otherwise
equals { tags : [version1, highPriority] }
</pre></div>
<div class="section">
<h3>extractURIComponents<a name="extractURIComponents"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ExtractURIComponentsBuilder.java">extractURIComponents</a> command extracts subcomponents from the URIs contained in the given input field and adds them to output fields with the given prefix, namely scheme, authority, host, port, path, query, fragment, schemeSpecificPart, userInfo.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> inputField </td>
<td> n/a </td>
<td> The name of the input field that contains zero or more URIs. </td></tr>
<tr class="a">
<td> outputFieldPrefix </td>
<td> &quot;&quot; </td>
<td> A prefix to prepend to output field names. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>extractURIComponents {
  inputField : my_uri
  outputFieldPrefix : uri_component_
}
</pre></div>
<p>For example, given the input field <tt>myUri</tt> with the value <tt>http://userinfo@www.bar.com:8080/errors.log?foo=x&amp;bar=y&amp;foo=z#fragment</tt> the expected output is as follows:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Name </b></th>
<th><b> Value </b></th></tr>
<tr class="b">
<td> myUri </td>
<td> http://userinfo@www.bar.com:8080/errors.log?foo=x&amp;bar=y&amp;foo=z#fragment </td></tr>
<tr class="a">
<td> uri_component_authority </td>
<td> userinfo@www.bar.com:8080 </td></tr>
<tr class="b">
<td> uri_component_fragment </td>
<td> fragment </td></tr>
<tr class="a">
<td> uri_component_host </td>
<td> www.bar.com </td></tr>
<tr class="b">
<td> uri_component_path </td>
<td> /errors.log </td></tr>
<tr class="a">
<td> uri_component_port </td>
<td> 8080 </td></tr>
<tr class="b">
<td> uri_component_query </td>
<td> foo=x&amp;bar=y&amp;foo=z </td></tr>
<tr class="a">
<td> uri_component_scheme </td>
<td> http </td></tr>
<tr class="b">
<td> uri_component_schemeSpecificPart </td>
<td> //userinfo@www.bar.com:8080/errors.log?foo=x&amp;bar=y&amp;foo=z </td></tr>
<tr class="a">
<td> uri_component_userInfo </td>
<td> userinfo </td></tr></table>
<div class="section">
<h3>extractURIQueryParameters<a name="extractURIQueryParameters"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ExtractURIQueryParametersBuilder.java">extractURIQueryParameters</a> command extracts the query parameters with a given name from the URIs contained in the given input field and appends them to the given output field.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> parameter </td>
<td> n/a </td>
<td> The name of the query parameter to find. </td></tr>
<tr class="a">
<td> inputField </td>
<td> n/a </td>
<td> The name of the input field that contains zero or more URI values. </td></tr>
<tr class="b">
<td> outputField </td>
<td> n/a </td>
<td> The field to add output values to. </td></tr>
<tr class="a">
<td> maxParameters </td>
<td> 1000000000 </td>
<td> The maximum number of values to append to the output field per input field. </td></tr>
<tr class="b">
<td> charset </td>
<td> UTF-8 </td>
<td> The character encoding to use, for example, UTF-8. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>extractURIQueryParameters {
  parameter : foo
  inputField : myUri
  outputField : my_query_params
}
</pre></div>
<p>For example, given the input field <tt>myUri</tt> with the value <tt>http://userinfo@www.bar.com/errors.log?foo=x&amp;bar=y&amp;foo=z#fragment</tt> the expected output record is:</p>
<div class="source">
<pre>my_query_params:x
my_query_params:z
</pre></div>
<div class="section">
<h3>findReplace<a name="findReplace"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/FindReplaceBuilder.java">findReplace</a> command examines each string value in a given field and replaces each substring of the string value that matches the given string literal or grok pattern with the given replacement.</p>
<p>This command also supports grok dictionaries and regexes in the same way as the <a href="#grok">grok</a> command.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> field </td>
<td> n/a </td>
<td> The name of the field to modify. </td></tr>
<tr class="a">
<td> pattern </td>
<td> n/a </td>
<td> The search string to match. </td></tr>
<tr class="b">
<td> isRegex </td>
<td> false </td>
<td> Whether or not to interpret the pattern as a grok pattern (true) or string literal (false). </td></tr>
<tr class="a">
<td> dictionaryFiles </td>
<td> [] </td>
<td> A list of zero or more local files or directory trees from which to load dictionaries. Only applicable if <tt>isRegex</tt> is <tt>true</tt>. See <a href="#grok">grok</a> command. </td></tr>
<tr class="b">
<td> dictionaryString </td>
<td> null </td>
<td> An optional inline string from which to load a dictionary. Only applicable if <tt>isRegex</tt> is <tt>true</tt>. See <a href="#grok">grok</a> command. </td></tr>
<tr class="a">
<td> replacement </td>
<td> n/a </td>
<td> The replacement pattern (<tt>isRegex</tt> is <tt>true</tt>) or string literal (<tt>isRegex</tt> is <tt>false</tt>). </td></tr>
<tr class="b">
<td> replaceFirst </td>
<td> false </td>
<td> For each field value, whether or not to skip any matches beyond the first match. </td></tr></table>
<p>Example usage with grok pattern:</p>
<div class="source">
<pre>findReplace { 
  field : message
  dictionaryFiles : [cdk-morphlines-core/src/test/resources/grok-dictionaries]                               
  pattern : &quot;&quot;&quot;%{WORD:myGroup}&quot;&quot;&quot;
  #pattern : &quot;&quot;&quot;(\b\w+\b)&quot;&quot;&quot;      
  isRegex : true
  replacement : &quot;${myGroup}!&quot;
  #replacement : &quot;$1!&quot;
  #replacement : &quot;&quot;
  replaceFirst : false
}
</pre></div>
<p>Input: <tt>&quot;hello world&quot;</tt></p>
<p>Expected output: <tt>&quot;hello! world!&quot;</tt></p>
<div class="section">
<h3>generateUUID<a name="generateUUID"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/GenerateUUIDBuilder.java">generateUUID</a> command sets a universally unique identifier on all records that are intercepted. An example UUID is b5755073-77a9-43c1-8fad-b7a586fc1b97, which represents a 128bit value.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> field </td>
<td> id </td>
<td> The name of the field to set. </td></tr>
<tr class="a">
<td> preserveExisting </td>
<td> true </td>
<td> Whether to preserve the field value if one is already present. </td></tr>
<tr class="b">
<td> prefix </td>
<td> &quot;&quot; </td>
<td> The prefix string constant to prepend to each generated UUID. </td></tr>
<tr class="a">
<td> type </td>
<td> secure </td>
<td> This parameter must be one of &quot;secure&quot; or &quot;nonSecure&quot; and indicates the algorithm used for UUID generation. Unfortunately, the cryptographically &quot;secure&quot; algorithm can be comparatively slow - if it uses /dev/random on Linux, it can block waiting for sufficient entropy to build up. In contrast, the &quot;nonSecure&quot; algorithm never blocks and is much faster. The &quot;nonSecure&quot; algorithm uses a secure random seed but is otherwise deterministic, though it is one of the <a class="externalLink" href="http://bit.ly/12H7NHo">strongest uniform pseudo random number generators known so far</a>. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>generateUUID {
  field : my_id
}
</pre></div>
<div class="section">
<h3>grok<a name="grok"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/GrokBuilder.java">grok</a> command uses regular expression pattern matching to extract structured fields from unstructured log data.</p>
<p>This is well suited for syslog logs, apache, and other webserver logs, mysql logs, and in general, any log format that is generally written for humans and not computer consumption.</p>
<p>A grok command can load zero or more dictionaries. A dictionary is a file or string that contains zero or more REGEXNAME to REGEX mappings, one per line, separated by space, for example:</p>
<div class="source">
<pre>INT (?:[+-]?(?:[0-9]+))
HOSTNAME \b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\.?|\b)
</pre></div>
<p>For example, the regex named &quot;INT&quot; is associated with the following <a class="externalLink" href="http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html">regex pattern</a>:</p>
<div class="source">
<pre>[+-]?(?:[0-9]+)
</pre></div>
<p>and matches strings like &quot;123&quot;, whereas the regex named &quot;HOSTNAME&quot; is associated with the following regex pattern:</p>
<div class="source">
<pre>\b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\.?|\b)
</pre></div>
<p>and matches strings like &quot;www.cloudera.com&quot;.</p>
<p>Morphlines ships with <a class="externalLink" href="https://github.com/cloudera/cdk/tree/master/cdk-morphlines/cdk-morphlines-core/src/test/resources/grok-dictionaries">several standard grok dictionaries</a>.</p>
<p>A grok command can contain zero or more grok expressions. Each grok expression refers to a record input field name and can contain zero or more grok patterns. The following is an example grok expression that refers to the input field named &quot;message&quot; and contains two grok patterns:</p>
<div class="source">
<pre>expressions : {
  message : &quot;&quot;&quot;\s+%{INT:pid} %{HOSTNAME:my_name_servers}&quot;&quot;&quot;
}
</pre></div>
<p>The syntax for a grok pattern is</p>
<div class="source">
<pre>%{REGEX_NAME:GROUP_NAME}
</pre></div>
<p>for example</p>
<div class="source">
<pre>%{INT:pid}
</pre></div>
<p>or</p>
<div class="source">
<pre>%{HOSTNAME:my_name_servers}
</pre></div>
<p>The REGEXNAME is the name of a regex within a loaded dictionary.</p>
<p>The GROUPNAME is the name of an output field.</p>
<p>If all expressions of the grok command match the input record, then the command succeeds and the content of the named capturing group is added to this output field of the output record. Otherwise, the record remains unchanged and the grok command fails, causing backtracking of the command chain.</p>
<dl>
<dd>Note: The morphline configuration file is implemented using the HOCON format (Human Optimized Config Object Notation). HOCON is basically JSON slightly adjusted for the configuration file use case. HOCON syntax is defined at <a class="externalLink" href="http://github.com/typesafehub/config/blob/master/HOCON.md">HOCON github page</a> and as such, multi-line strings are similar to Python or Scala, using triple quotes. If the three-character sequence <tt>&quot;&quot;&quot;</tt> appears, then all Unicode characters until a closing <tt>&quot;&quot;&quot;</tt> sequence are used unmodified to create a string value.</dd></dl>
<p>In addition, the grok command supports the following parameters:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> dictionaryFiles </td>
<td> [] </td>
<td> A list of zero or more local files or directory trees from which to load dictionaries. </td></tr>
<tr class="a">
<td> dictionaryString </td>
<td> null </td>
<td> An optional inline string from which to load a dictionary. </td></tr>
<tr class="b">
<td> extract </td>
<td> true </td>
<td> Can be &quot;false&quot;, &quot;true&quot;, or &quot;inplace&quot;. Add the content of named capturing groups to the input record (&quot;inplace&quot;), to a copy of the input record (&quot;true&quot;), or to no record (&quot;false&quot;). </td></tr>
<tr class="a">
<td> numRequiredMatches </td>
<td> atLeastOnce </td>
<td> Indicates the minimum and maximum number of field values that must match a given grok expression for each input field name. Can be &quot;atLeastOnce&quot; (default), &quot;once&quot;, or &quot;all&quot;. </td></tr>
<tr class="b">
<td> findSubstrings </td>
<td> false </td>
<td> Indicates whether the grok expression must match the entire input field value or merely a substring within. </td></tr>
<tr class="a">
<td> addEmptyStrings </td>
<td> false </td>
<td> Indicates whether zero length strings stemming from empty (but matching) capturing groups shall be added to the output record. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre># Index syslog formatted files
#
# Example input line:
#
# &lt;164&gt;Feb  4 10:46:14 syslog sshd[607]: listening on 0.0.0.0 port 22.
#
# Expected output record fields:
#
# syslog_pri:164
# syslog_timestamp:Feb  4 10:46:14
# syslog_hostname:syslog
# syslog_program:sshd
# syslog_pid:607
# syslog_message:listening on 0.0.0.0 port 22.
#
grok {
  dictionaryFiles : [cdk-morphlines-core/src/test/resources/grok-dictionaries]
  expressions : {
    message : &quot;&quot;&quot;&lt;%{POSINT:syslog_pri}&gt;%{SYSLOGTIMESTAMP:syslog_timestamp} %{SYSLOGHOST:syslog_hostname} %{DATA:syslog_program}(?:\[%{POSINT:syslog_pid}\])?: %{GREEDYDATA:syslog_message}&quot;&quot;&quot;

    #message2 : &quot;(?&lt;queue_field&gt;.*)&quot;
    #message4 : &quot;%{NUMBER:queue_field}&quot;
  }
}
</pre></div>
<p>More example usage:</p>
<div class="source">
<pre># Split a line on one or more whitespace into substrings,
# and add the substrings to the &quot;columns&quot; output field.
#
# Example input line with tabs:
#
# &quot;hello\t\tworld\tfoo&quot;
#
# Expected output record fields:
#
# columns:hello
# columns:world
# columns:foo
#
grok {
  expressions : {
    message : &quot;&quot;&quot;(?&lt;columns&gt;.+?)(\s+|\z)&quot;&quot;&quot;
  }
  findSubstrings : true
}
</pre></div>
<p>Even more example usage:</p>
<div class="source">
<pre># Index a custom variant of syslog files where subfacility is optional
#
# Example input line:
#
# &lt;179&gt;Jun 10 04:42:51 www.foo.com Jun 10 2013 04:42:51 : %myproduct-3-mysubfacility-123456: Health probe failed
#
# Expected output record fields:
#
# my_message_code:%myproduct-3-mysubfacility-123456
# my_product:myproduct
# my_level:3
# my_subfacility:mysubfacility
# my_message_id:123456
# syslog_message:%myproduct-3-mysubfacility-123456: Health probe failed
#
grok {
  dictionaryFiles : [cdk-morphlines-core/src/test/resources/grok-dictionaries]
  dictionaryString : &quot;&quot;&quot;
    MY_CUSTOM_TIMESTAMP %{MONTH} %{MONTHDAY} %{YEAR} %{TIME}
  &quot;&quot;&quot;

  expressions : {
    message : &quot;&quot;&quot;&lt;%{POSINT}&gt;%{SYSLOGTIMESTAMP} %{SYSLOGHOST} %{MY_CUSTOM_TIMESTAMP} : (?&lt;syslog_message&gt;(?&lt;my_message_code&gt;%%{\w+:my_product}-%{\w+:my_level}(-%{\w+:my_subfacility})?-%{\w+:my_message_id}): %{GREEDYDATA})&quot;&quot;&quot;
  }
}
</pre></div>
<dl>
<dd>Note: An easy way to test grok out is to use the <a class="externalLink" href="http://grokdebug.herokuapp.com/">online grok debugger</a> from the logstash project. There is also a corresponding <a class="externalLink" href="http://www.youtube.com/watch?v=YIKm6WUgFTY">YouTube video</a>.</dd></dl>
<div class="section">
<h3>if<a name="if"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/IfThenElseBuilder.java">if</a> command consists of a chain of zero or more conditions commands, as well as an optional chain of zero or or more commands that are processed if all conditions succeed (&quot;<tt>then</tt> commands&quot;), as well as an optional chain of zero or more commands that are processed if one of the conditions fails (&quot;<tt>else</tt> commands&quot;).</p>
<p>If one of the commands in the <tt>then</tt> chain or <tt>else</tt> chain fails, then the entire <tt>if</tt> command fails and any remaining commands in the <tt>then</tt> or <tt>else</tt> branch are skipped.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> conditions </td>
<td> [] </td>
<td> A list of zero or more commands. </td></tr>
<tr class="a">
<td> then </td>
<td> [] </td>
<td> A list of zero or more commands. </td></tr>
<tr class="b">
<td> else </td>
<td> [] </td>
<td> A list of zero or more commands. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>if {
  conditions : [
    { contains { _attachment_mimetype : [avro/binary] } }
  ]
  then : [
    { logInfo { format : &quot;processing then...&quot; } }
  ]
  else : [
    { logInfo { format : &quot;processing else...&quot; } }
  ]
}
</pre></div>
<div class="section">
<h3>java<a name="java"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/JavaBuilder.java">java</a> command compiles and executes the given Java code block, wrapped into a Java method with a Boolean return type and several parameters, along with a Java class definition that contains the given import statements.</p>
<p>The parameters passed to the code block are <tt>record</tt>, <tt>config</tt>, <tt>parent</tt>, <tt>child</tt>, <tt>context</tt>, <tt>logger</tt> and are of types <tt>Record</tt>, <tt>Config</tt>, <tt>Command</tt>, <tt>Command</tt>, <tt>MorphlineContext</tt>, <tt>Logger</tt>, respectively.</p>
<p>Compilation is done in main memory, meaning without writing to the filesystem.</p>
<p>The result is an object that can be executed (and reused) any number of times. This is a high performance implementation, using an optimized variant of <a class="externalLink" href="https://scripting.dev.java.net/">https://scripting.dev.java.net/</a>&quot; (JSR 223 Java Scripting). Calling <tt>eval()</tt> just means calling <tt>Method.invoke()</tt>, and, as such, has the same minimal runtime cost. As a result of the low cost, this command can be called on the order of 100 million times per second per CPU core on industry standard hardware.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> imports </td>
<td> A default list sufficient for typical usage. </td>
<td> A string containing zero or more Java import declarations. </td></tr>
<tr class="a">
<td> code </td>
<td> [] </td>
<td> A Java code block as defined in the Java language specification. Must return a Boolean value. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>java {
  imports : &quot;import java.util.*;&quot;
  code: &quot;&quot;&quot;
    List tags = record.get(&quot;tags&quot;);
    if (!tags.contains(&quot;hello&quot;)) {
      return false;
    }
    tags.add(&quot;world&quot;);
    return child.process(record);
        &quot;&quot;&quot;
}
</pre></div>
<p><a name="logTrace"></a></p>
<div class="section">
<h3>logTrace, logDebug, logInfo, logWarn, logError<a name="logTrace_logDebug_logInfo_logWarn_logError"></a></h3></div>
<p>These commands log a message to <a class="externalLink" href="http://www.slf4j.org">slf4j</a> at the given log level. The command can fetch the values of a record field using a <i>field expression</i>, which is a string of the form @{fieldname}. The special field expression @{} can be used to log the entire record.</p>
<p>Example usage:</p>
<div class="source">
<pre># log the entire record at DEBUG level to SLF4J
logDebug { format : &quot;my record: {}&quot;, args : [&quot;@{}&quot;] }
</pre></div>
<p>More example usage:</p>
<div class="source">
<pre># log the timestamp field and the entire record at INFO level to SLF4J
logInfo {
  format : &quot;timestamp: {}, record: {}&quot;
  args : [&quot;@{timestamp}&quot;, &quot;@{}&quot;]
}
</pre></div>
<p>To automatically print diagnostic information such as the content of records as they pass through the morphline commands, consider enabling TRACE log level, for example by adding the following line to your log4j.properties file:</p>
<div class="source">
<pre>log4j.logger.com.cloudera.cdk.morphline=TRACE
</pre></div>
<div class="section">
<h3>not<a name="not"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/NotBuilder.java">not</a> command consists of one nested command, the Boolean return value of which is inverted.</p>
<p>Example usage:</p>
<div class="source">
<pre>if {
  conditions : [
    {
      not {
        grok {
          ... some grok expressions go here
        }
      }
    }
  ]
  then : [
    { logDebug { format : &quot;found no grok match: {}&quot;, args : [&quot;@{}&quot;] } }
    { dropRecord {} }
  ]
  else : [
    { logDebug { format : &quot;found grok match: {}&quot;, args : [&quot;@{}&quot;] } }
  ]
}
</pre></div>
<div class="section">
<h3>pipe<a name="pipe"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/Pipe.java">pipe</a> command has an identifier and contains a chain of zero or more commands, through which records get piped. A command transforms the record into zero or more records. The output records of a command are passed to the next command in the chain. A command has a Boolean return code, indicating success or failure. If any command in the pipe fails (meaning that it returns <tt>false</tt>), the whole pipe fails (meaning that it returns <tt>false</tt>), which causes backtracking of the command chain.</p>
<p>Because a pipe is itself a command, a pipe can contain arbitrarily nested pipes. A <i>morphline</i> is a pipe. &quot;Morphline&quot; is simply another name for the pipe at the root of the command tree.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> id </td>
<td> n/a </td>
<td> An identifier for this pipe. </td></tr>
<tr class="a">
<td> importCommands </td>
<td> [] </td>
<td> A list of zero or more import specifications, each of which makes all morphline commands that match the specification visible to the morphline. A specification can import all commands in an entire Java package tree (specification ends with &quot;.**&quot;), all commands in a Java package (specification ends with &quot;.*&quot;), or the command of a specific fully qualified Java class (all other specifications). Other commands present on the Java classpath are not visible to this morphline. </td></tr>
<tr class="b">
<td> commands </td>
<td> [] </td>
<td> A list of zero or more commands. </td></tr></table>
<p>Example usage demonstrating a pipe with two commands, namely <tt>addValues</tt> and <tt>logDebug</tt>:</p>
<div class="source">
<pre>pipe {
  id : my_pipe

  # Import all commands in these java packages, subpackages and classes.
  # Other commands on the Java classpath are not visible to this morphline.
  importCommands : [
    &quot;com.cloudera.**&quot;,   # package and all subpackages
    &quot;org.apache.solr.**&quot;, # package and all subpackages
    &quot;com.mycompany.mypackage.*&quot;, # package only
    &quot;com.cloudera.cdk.morphline.stdlib.GrokBuilder&quot; # fully qualified class
  ]

  commands : [
    { addValues { foo : bar }}
    { logDebug { format : &quot;output record: {}&quot;, args : [&quot;@{}&quot;] } }
  ]
}
</pre></div>
<div class="section">
<h3>separateAttachments<a name="separateAttachments"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/SeparateAttachmentsBuilder.java">separateAttachments</a> command emits one output record for each attachment in the input record's list of attachments. The result is many records, each of which has at most one attachment.</p>
<p>Example usage:</p>
<div class="source">
<pre>separateAttachments {}
</pre></div>
<div class="section">
<h3>setValues<a name="setValues"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/SetValuesBuilder.java">setValues</a> command is the same as the <tt>addValues</tt> command, except that it first removes all values from the given output field, and then it adds new values.</p>
<p>Example usage:</p>
<div class="source">
<pre>setValues {
  # assign values &quot;text/log&quot; and &quot;text/log2&quot; to source_type output field
  source_type : [text/log, text/log2]

  # assign the integer 123 to the pid field
  pid : [123]

  # assign all values contained in the first_name field to the name field
  name : &quot;@{first_name}&quot;
}
</pre></div>
<div class="section">
<h3>split<a name="split"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/SplitBuilder.java">split</a> command divides strings into substrings, by recognizing a <i>separator</i> (a.k.a. &quot;delimiter&quot;) which can be expressed as a single character, literal string, regular expression, or grok pattern. This class provides the functionality of Guava's <a class="externalLink" href="http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Splitter.html">Splitter</a> class as a morphline command, plus it also supports grok dictionaries and regexes in the same way as the <a href="#grok">grok</a> command.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> inputField </td>
<td> n/a </td>
<td> The name of the input field. </td></tr>
<tr class="a">
<td> outputField </td>
<td> n/a </td>
<td> The name of the field to add output values to. </td></tr>
<tr class="b">
<td> separator </td>
<td> n/a </td>
<td> The delimiting string to search for. </td></tr>
<tr class="a">
<td> isRegex </td>
<td> false </td>
<td> Whether or not to interpret the separator as a grok pattern (true) or string literal (false). </td></tr>
<tr class="b">
<td> dictionaryFiles </td>
<td> [] </td>
<td> A list of zero or more local files or directory trees from which to load dictionaries. Only applicable if <tt>isRegex</tt> is <tt>true</tt>. See <a href="#grok">grok</a> command. </td></tr>
<tr class="a">
<td> dictionaryString </td>
<td> null </td>
<td> An optional inline string from which to load a dictionary. Only applicable if <tt>isRegex</tt> is <tt>true</tt>. See <a href="#grok">grok</a> command. </td></tr>
<tr class="b">
<td> trim </td>
<td> true </td>
<td> Whether or not to apply the <tt>String.trim()</tt> method on the output values to be added. </td></tr>
<tr class="a">
<td> addEmptyStrings </td>
<td> false </td>
<td> Whether or not to add zero length strings to the output field. </td></tr>
<tr class="b">
<td> limit </td>
<td> -1 </td>
<td> The maximum number of items to add to the output field per input field value. -1 indicates unlimited. </td></tr></table>
<p>Example usage with literal string:</p>
<div class="source">
<pre>split { 
  inputField : message
  outputField : output          
  separator : &quot;,&quot;        
  isRegex : false      
  #separator : &quot;&quot;&quot;\s*,\s*&quot;&quot;&quot;        
  #isRegex : true      
  addEmptyStrings : false
  trim : true          
}
</pre></div>
<p>Input:</p>
<div class="source">
<pre>message:&quot;_a ,_b_ ,c__&quot;
</pre></div>
<p>Expected output:</p>
<div class="source">
<pre>output:_a
output:_b_
output:c__
</pre></div>
<p>Example usage with grok pattern or normal regex:</p>
<div class="source">
<pre>split { 
  inputField : message
  outputField : output
  # dictionaryFiles : [cdk-morphlines-core/src/test/resources/grok-dictionaries] 
  dictionaryString : &quot;&quot;&quot;COMMA_SURROUNDED_BY_WHITESPACE \s*,\s*&quot;&quot;&quot;          
  separator : &quot;&quot;&quot;%{COMMA_SURROUNDED_BY_WHITESPACE}&quot;&quot;&quot;        
  # separator : &quot;&quot;&quot;\s*,\s*&quot;&quot;&quot;        
  isRegex : true      
  addEmptyStrings : true
  trim : false          
}
</pre></div>
<div class="section">
<h3>toString<a name="toString"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/ToStringBuilder.java">toString</a> command converts the Java objects in a given field using the <tt>Object.toString()</tt> method to their string representation, and optionally also applies the <tt>String.trim()</tt> method.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> field </td>
<td> n/a </td>
<td> The name of the field to convert. </td></tr>
<tr class="a">
<td> trim </td>
<td> false </td>
<td> Whether or not to apply the <tt>String.trim()</tt> method. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>toString { field : source_type }
</pre></div>
<div class="section">
<h3>translate<a name="translate"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/TranslateBuilder.java">translate</a> command examines each value in a given field and replaces it with the replacement value defined in a given dictionary aka lookup hash table.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> field </td>
<td> n/a </td>
<td> The name of the field to modify. </td></tr>
<tr class="a">
<td> dictionary </td>
<td> n/a </td>
<td> The lookup hash table to use for finding matches and replacement values </td></tr>
<tr class="b">
<td> fallback </td>
<td> null </td>
<td> The fallback value to use as replacement if no match is found. If no fallback is defined and no match is found then the command fails. </td></tr></table>
<p>Example usage to translate <a class="externalLink" href="http://en.wikipedia.org/wiki/Syslog#Severity_levels">Syslog severity level</a> numeric codes to string labels:</p>
<div class="source">
<pre>translate {
  field : level
  dictionary : {
     0 : Emergency
     1 : Alert
     2 : Critical
     3 : Error
     4 : Warning
     5 : Notice
     6 : Informational
     7 : Debug
  }
  fallback : Unknown # if no fallback is defined and no match is found then the command fails
}
</pre></div>
<p>Input: <tt>level:0</tt></p>
<p>Expected output: <tt>level:Emergency</tt></p>
<p>Input: <tt>level:999</tt></p>
<p>Expected output: <tt>level:Unknown</tt></p>
<div class="section">
<h3>tryRules<a name="tryRules"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-core/src/main/java/com/cloudera/cdk/morphline/stdlib/TryRulesBuilder.java">tryRules</a> command consists of zero or more rules. A rule consists of zero or more commands.</p>
<p>The rules of a <tt>tryRules</tt> command are processed in topdown order. If one of the commands in a rule fails, the <tt>tryRules</tt> command stops processing this rule, backtracks and tries the next rule, and so on, until a rule is found that runs all its commands to completion without failure (the rule <i>succeeds</i>). If a rule succeeds, the remaining rules of the current <tt>tryRules</tt> command are skipped. If no rule succeeds the record remains unchanged, but a warning may be issued or an exception may be thrown.</p>
<p>Because a <tt>tryRules</tt> command is itself a command, a <tt>tryRules</tt> command can contain arbitrarily nested <tt>tryRules</tt> commands. By the same logic, a <tt>pipe</tt> command can contain arbitrarily nested <tt>tryRules</tt> commands and a <tt>tryRules</tt> command can contain arbitrarily nested <tt>pipe</tt> commands. This helps to implement complex functionality for advanced usage.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> catchExceptions </td>
<td> false </td>
<td> Whether Java exceptions thrown by a rule shall be caught, with processing continuing with the next rule (<tt>true</tt>), or whether such exceptions shall not be caught and consequently propagate up the call chain (<tt>false</tt>). </td></tr>
<tr class="a">
<td> throwExceptionIfAllRulesFailed </td>
<td> true </td>
<td> Whether to throw a Java exception if no rule succeeds. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>tryRules {
  catchExceptions : false
  throwExceptionIfAllRulesFailed : true
  rules : [
    # next rule of tryRules cmd:
    {
      commands : [
        { contains { _attachment_mimetype : [avro/binary] } }
        ... handle Avro data here
        { logDebug { format : &quot;output record: {}&quot;, args : [&quot;@{}&quot;] } }
      ]
    }

    # next rule of tryRules cmd:
    {
      commands : [
        { contains { _attachment_mimetype : [text/csv] } }
        ... handle CSV data here
        { logDebug { format : &quot;output record: {}&quot;, args : [&quot;@{}&quot;] } }
      ]
    }
  ]
}
</pre></div>
<div class="section">
<h2>cdk-morphlines-avro<a name="cdk-morphlines-avro"></a></h2></div>
<p>This module contains morphline commands for reading, extracting, and transforming Avro files and Avro objects.</p>
<div class="section">
<h3>readAvroContainer<a name="readAvroContainer"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-avro/src/main/java/com/cloudera/cdk/morphline/avro/ReadAvroContainerBuilder.java">readAvroContainer</a> command parses an InputStream or byte array that contains Avro binary container file data. For each Avro datum, the command emits a morphline record containing the datum as an attachment in the field _attachment_body.</p>
<p>The Avro schema that was used to write the Avro data is retrieved from the Avro container. Optionally, the Avro schema that shall be used for reading can be supplied with a configuration option; otherwise it is assumed to be the same as the writer schema.</p>
<dl>
<dd>Note: Avro uses <a class="externalLink" href="http://avro.apache.org/docs/current/spec.html#Schema+Resolution">Schema Resolution</a> if the two schemas are different, e.g. if the reader schema is a subset of the writer schema for the purpose of efficient column projection.</dd></dl>
<p>The input stream or byte array is read from the first attachment of the input record.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> supportedMimeTypes </td>
<td> null </td>
<td> Optionally, require the input record to match one of the MIME types in this list. </td></tr>
<tr class="a">
<td> readerSchemaFile </td>
<td> null </td>
<td> An optional Avro schema file in JSON format on the local file system to use for reading. </td></tr>
<tr class="b">
<td> readerSchemaString </td>
<td> null </td>
<td> An optional Avro schema in JSON format given inline to use for reading. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre># Parse Avro container file and emit a record for each avro object
readAvroContainer {
  # Optionally, require the input to match one of these MIME types:
  # supportedMimeTypes : [avro/binary]

  # Optionally, use this Avro schema in JSON format inline for reading:
  # readerSchemaString : &quot;&quot;&quot;&lt;json can go here&gt;&quot;&quot;&quot;

  # Optionally, use this Avro schema file in JSON format for reading:
  # readerSchemaFile : /path/to/syslog.avsc
}
</pre></div>
<div class="section">
<h3>readAvro<a name="readAvro"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-avro/src/main/java/com/cloudera/cdk/morphline/avro/ReadAvroBuilder.java">readAvro</a> command is the same as the <tt>readAvroContainer</tt> command except that the Avro schema that was used to write the Avro data must be explicitly supplied to the <tt>readAvro</tt> command because it expects raw Avro data without an Avro container and hence without a builtin writer schema.</p>
<p>Optionally, the Avro schema that shall be used for reading can be supplied with a configuration option; otherwise it is assumed to be the same as the writer schema.</p>
<dl>
<dd>Note: Avro uses <a class="externalLink" href="http://avro.apache.org/docs/current/spec.html#Schema+Resolution">Schema Resolution</a> if the two schemas are different, e.g. if the reader schema is a subset of the writer schema for the purpose of efficient column projection.</dd></dl>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> supportedMimeTypes </td>
<td> null </td>
<td> Optionally, require the input record to match one of the MIME types in this list. </td></tr>
<tr class="a">
<td> readerSchemaFile </td>
<td> null </td>
<td> An optional Avro schema file in JSON format on the local file system to use for reading. </td></tr>
<tr class="b">
<td> readerSchemaString </td>
<td> null </td>
<td> An optional Avro schema in JSON format given inline to use for reading. </td></tr>
<tr class="a">
<td> writerSchemaFile </td>
<td> null </td>
<td> The Avro schema file in JSON format that was used to write the Avro data. </td></tr>
<tr class="b">
<td> writerSchemaString </td>
<td> null </td>
<td> The Avro schema file in JSON format that was used to write the Avro data given inline. </td></tr>
<tr class="a">
<td> isJson </td>
<td> false </td>
<td> Whether the Avro input data is encoded as JSON or binary. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre># Parse Avro and emit a record for each avro object
readAvro {
  # supportedMimeTypes : [avro/binary]
  # readerSchemaString : &quot;&quot;&quot;&lt;json can go here&gt;&quot;&quot;&quot;
  # readerSchemaFile : test-documents/sample-statuses-20120906-141433-subschema.avsc
  # writerSchemaString : &quot;&quot;&quot;&lt;json can go here&gt;&quot;&quot;&quot;
  writerSchemaFile : test-documents/sample-statuses-20120906-141433.avsc
}
</pre></div>
<div class="section">
<h3>extractAvroTree<a name="extractAvroTree"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-avro/src/main/java/com/cloudera/cdk/morphline/avro/ExtractAvroTreeBuilder.java">extractAvroTree</a> command converts an attached Avro datum to a morphline record by recursively walking the Avro tree and extracting all data into a single morphline record, with fields named by their path in the Avro tree.</p>
<p>The Avro input object is expected to be contained in the field _attachment_body, and typically placed there by an upstream <tt>readAvroContainer</tt> or <tt>readAvro</tt> command.</p>
<p>This kind of mapping is useful for simple Avro schemas, but for more complex schemas, this approach may be overly simplistic and expensive.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> outputFieldPrefix </td>
<td> &quot;&quot; </td>
<td> A string to be prepended to each output field name. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>extractAvroTree {
  outputFieldPrefix : &quot;&quot;
}
</pre></div>
<div class="section">
<h3>extractAvroPaths<a name="extractAvroPaths"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-avro/src/main/java/com/cloudera/cdk/morphline/avro/ExtractAvroPathsBuilder.java">extractAvroPaths</a> command uses zero or more Avro path expressions to extract values from an Avro object.</p>
<p>The Avro input object is expected to be contained in the field _attachment_body, and typically placed there by an upstream <tt>readAvroContainer</tt> or <tt>readAvro</tt> command.</p>
<p>Each path expression consists of a record output field name (on the left side of the colon ':') as well as zero or more path steps (on the right hand side), each path step separated by a '/' slash, akin to a simple form of XPath. Avro arrays are traversed with the '[]' notation.</p>
<p>The result of a path expression is a list of objects, each of which is added to the given record output field.</p>
<p>The path language supports all Avro concepts, including such concepts as nested structures, records, arrays, maps, and unions. The path language supports a flatten option that collects the primitives in a subtree into a flat output list.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> flatten </td>
<td> true </td>
<td> Whether to collect the primitives in a subtree into a flat output list. </td></tr>
<tr class="a">
<td> paths </td>
<td> [] </td>
<td> Zero or more Avro path expressions. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>extractAvroPaths {
  flatten : true
  paths : {
    my_price : /price

    my_docId : /docId
    my_links : /links
    my_links_backward : &quot;/links/backward&quot;
    my_links_forward : &quot;/links/forward&quot;
    my_name_language_code : &quot;/name[]/language[]/code&quot;
    my_name_language_country : &quot;/name[]/language[]/country&quot;
    my_name : /name

    /mymapField/foo/label : /mapField/foo/label/
  }
}
</pre></div>
<div class="section">
<h2>cdk-morphlines-json<a name="cdk-morphlines-json"></a></h2></div>
<p>This module contains morphline commands for reading, extracting, and transforming JSON files and JSON objects.</p>
<div class="section">
<h3>readJson<a name="readJson"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-json/src/main/java/com/cloudera/cdk/morphline/json/ReadJsonBuilder.java">readJson</a> command parses an InputStream or byte array that contains JSON data. For each top level JSON object, the command emits a morphline record containing the top level object as an attachment in the field _attachment_body.</p>
<p>The input stream or byte array is read from the first attachment of the input record.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> outputClass </td>
<td> <a class="externalLink" href="http://wiki.fasterxml.com/JacksonTreeModel">com.fasterxml.jackson.databind.JsonNode</a> </td>
<td> The fully qualified name of a Java class that <a class="externalLink" href="https://github.com/FasterXML/jackson-databind">Jackson</a> shall convert to. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>readJson {}
</pre></div>
<p>Example usage with conversion from JSON to <tt>java.util.Map</tt> objects:</p>
<div class="source">
<pre>readJson {
  outputClass : java.util.Map
}
</pre></div>
<div class="section">
<h3>extractJsonPaths<a name="extractJsonPaths"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-json/src/main/java/com/cloudera/cdk/morphline/json/ExtractJsonPathsBuilder.java">extractJsonPaths</a> command uses zero or more JSON path expressions to extract values from a <a class="externalLink" href="https://github.com/FasterXML/jackson-databind">Jackson</a> JSON object of outputClass <a class="externalLink" href="http://wiki.fasterxml.com/JacksonTreeModel">com.fasterxml.jackson.databind.JsonNode</a>.</p>
<p>The JSON input object is expected to be contained in the field _attachment_body, and typically placed there by an upstream <tt>readJson</tt> command with <tt>outputClass : com.fasterxml.jackson.databind.JsonNode</tt>.</p>
<p>Each path expression consists of a record output field name (on the left side of the colon ':') as well as zero or more path steps (on the right hand side), each path step separated by a '/' slash, akin to a simple form of XPath. JSON arrays are traversed with the '[]' notation.</p>
<p>The result of a path expression is a list of objects, each of which is added to the given record output field.</p>
<p>The path language supports all JSON concepts, including such concepts as nested objects, arrays, etc. The path language supports a flatten option that collects the primitives in a subtree into a flat output list.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> flatten </td>
<td> true </td>
<td> Whether to collect the primitives in a subtree into a flat output list. </td></tr>
<tr class="a">
<td> paths </td>
<td> [] </td>
<td> Zero or more JSON path expressions. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>extractJsonPaths {
  flatten : true
  paths : {
    my_price : /price

    my_docId : /docId
    my_links : /links
    my_links_backward : &quot;/links/backward&quot;
    my_links_forward : &quot;/links/forward&quot;
    my_name_language_code : &quot;/name[]/language[]/code&quot;
    my_name_language_country : &quot;/name[]/language[]/country&quot;
    my_name : /name    
  }
}
</pre></div>
<div class="section">
<h2>cdk-morphlines-hadoop-sequencefile<a name="cdk-morphlines-hadoop-sequencefile"></a></h2></div>
<div class="section">
<h3>readSequenceFile<a name="readSequenceFile"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-hadoop-sequencefile/src/main/java/com/cloudera/cdk/morphline/hadoop/sequencefile/ReadSequenceFileBuilder.java">readSequenceFile</a> command extracts zero or more records from the input stream of the first attachment of the record, representing an Apache Hadoop SequenceFile.</p>
<p>For the format and documentation of SequenceFiles see <a class="externalLink" href="http://archive.cloudera.com/cdh4/cdh/4/hadoop/api/org/apache/hadoop/io/SequenceFile.html">SequenceFile</a>.</p>
<p>The command automatically handles Record-Compressed and Block-Compressed SequenceFiles.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> keyField </td>
<td> _attachment_name </td>
<td> The name of the output field to store the SequenceFile Record key. </td></tr>
<tr class="a">
<td> valueField </td>
<td> _attachment_body </td>
<td> The name of the output field to store the SequenceFile Record value. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>readSequenceFile {
  keyField : &quot;key&quot;
  valueField : &quot;value&quot;
}
</pre></div>
<div class="section">
<h2>cdk-morphlines-tika-core<a name="cdk-morphlines-tika-core"></a></h2></div>
<p>This module contains morphline commands for autodetecting MIME types from binary data. Depends on tika-core.</p>
<div class="section">
<h3>detectMimeType<a name="detectMimeType"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-tika-core/src/main/java/com/cloudera/cdk/morphline/tika/DetectMimeTypeBuilder.java">detectMimeType</a> command uses Apache Tika to autodetect the <a class="externalLink" href="https://en.wikipedia.org/wiki/Internet_media_type">MIME type</a> of the first attachment from the binary data. The detected MIME type is assigned to the _attachment_mimetype field.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> includeDefaultMimeTypes </td>
<td> true </td>
<td> Whether to include the Tika default MIME types file that ships embedded in tika-core.jar (see <a class="externalLink" href="http://github.com/apache/tika/blob/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml">http://github.com/apache/tika/blob/trunk/tika-core/src/main/resources/org/apache/tika/mime/tika-mimetypes.xml</a>) </td></tr>
<tr class="a">
<td> mimeTypesFiles </td>
<td> [] </td>
<td> The relative or absolute path of zero or more Tika custom-mimetypes.xml files to include. </td></tr>
<tr class="b">
<td> mimeTypesString </td>
<td> null </td>
<td> The content of an optional custom-mimetypes.xml file embedded directly inside of this morphline configuration file. </td></tr>
<tr class="a">
<td> preserveExisting </td>
<td> true </td>
<td> Whether to preserve the _attachment_mimetype field value if one is already present. </td></tr>
<tr class="b">
<td> includeMetaData </td>
<td> false </td>
<td> Whether to pass the record fields to Tika to assist in MIME type detection. </td></tr>
<tr class="a">
<td> excludeParameters </td>
<td> true </td>
<td> Whether to remove MIME parameters from output MIME type. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>detectMimeType {
  includeDefaultMimeTypes : false
  #mimeTypesFiles : [src/test/resources/custom-mimetypes.xml]
  mimeTypesString :
    &quot;&quot;&quot;
    &lt;mime-info&gt;
      &lt;mime-type type=&quot;text/space-separated-values&quot;&gt;
        &lt;glob pattern=&quot;*.ssv&quot;/&gt;
      &lt;/mime-type&gt;

      &lt;mime-type type=&quot;avro/binary&quot;&gt;
        &lt;magic priority=&quot;50&quot;&gt;
          &lt;match value=&quot;0x4f626a01&quot; type=&quot;string&quot; offset=&quot;0&quot;/&gt;
        &lt;/magic&gt;
        &lt;glob pattern=&quot;*.avro&quot;/&gt;
      &lt;/mime-type&gt;

      &lt;mime-type type=&quot;mytwittertest/json+delimited+length&quot;&gt;
        &lt;magic priority=&quot;50&quot;&gt;
          &lt;match value=&quot;[0-9]+(\r)?\n\\{&amp;quot;&quot; type=&quot;regex&quot; offset=&quot;0:16&quot;/&gt;
        &lt;/magic&gt;
      &lt;/mime-type&gt;
    &lt;/mime-info&gt;
    &quot;&quot;&quot;
}
</pre></div>
<div class="section">
<h2>cdk-morphlines-tika-decompress<a name="cdk-morphlines-tika-decompress"></a></h2></div>
<p>This module contains morphline commands for decompressing and unpacking files. Depends on tika-core and commons-compress.</p>
<div class="section">
<h3>decompress<a name="decompress"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-tika-decompress/src/main/java/com/cloudera/cdk/morphline/tika/decompress/DecompressBuilder.java">decompress</a> command decompresses the first attachment, and supports gzip and bzip2 format.</p>
<p>Example usage:</p>
<div class="source">
<pre>decompress {}
</pre></div>
<div class="section">
<h3>unpack<a name="unpack"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-tika-decompress/src/main/java/com/cloudera/cdk/morphline/tika/decompress/UnpackBuilder.java">unpack</a> command unpacks the first attachment, and supports tar, zip, and jar format. The command emits one record per contained file.</p>
<p>Example usage:</p>
<div class="source">
<pre>unpack {}
</pre></div>
<div class="section">
<h2>cdk-morphlines-saxon<a name="cdk-morphlines-saxon"></a></h2></div>
<p>This module contains morphline commands for reading, extracting and transforming XML and HTML with XPath, XQuery and XSLT.</p>
<div class="section">
<h3>convertHTML<a name="convertHTML"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-saxon/src/main/java/com/cloudera/cdk/morphline/saxon/ConvertHTMLBuilder.java">convertHTML</a> command converts any HTML to XHTML, using the <a class="externalLink" href="http://ccil.org/~cowan/XML/tagsoup">TagSoup</a> Java library.</p>
<p>Instead of parsing well-formed or valid XML, this command parses HTML as it is found in the wild: poor, nasty and brutish, though quite often far from short. TagSoup (and hence this command) is designed for people who have to process this stuff using some semblance of a rational application design. By providing this converter, it allows standard XML tools to be applied to even the worst malformed HTML.</p>
<p>The command reads an InputStream or byte array from the first attachment (field _attachment_body) of the input record, parses it as HTML and replaces the field with UTF-8 encoded XHTML.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> supportedMimeTypes </td>
<td> null </td>
<td> Optionally, require the input record to match one of the MIME types in this list. </td></tr>
<tr class="a">
<td> charset </td>
<td> null </td>
<td> The character encoding to use for parsing input, for example, UTF-8. If none is specified the charset specified in the _attachment_charset input field is used instead. </td></tr>
<tr class="b">
<td> noNamespaces </td>
<td> true </td>
<td> A value of <tt>false</tt> indicates namespace URIs and unprefixed local names for element and attribute names will be available. </td></tr>
<tr class="a">
<td> noCDATA </td>
<td> false </td>
<td> A value of <tt>true</tt> indicates that the parser will treat CDATA elements specially. </td></tr>
<tr class="b">
<td> noBogons </td>
<td> false </td>
<td> A value of <tt>true</tt> indicates that the parser will ignore unknown elements. </td></tr>
<tr class="a">
<td> emptyBogons </td>
<td> false </td>
<td> A value of <tt>true</tt> indicates that the parser will give unknown elements a content model of EMPTY; a value of <tt>false</tt>, a content model of ANY. </td></tr>
<tr class="b">
<td> noRootBogons </td>
<td> false </td>
<td> A value of <tt>true</tt> indicates that the parser will allow unknown elements to be the root element. </td></tr>
<tr class="a">
<td> noDefaultAttributes </td>
<td> false </td>
<td> A value of <tt>true</tt> indicates that the parser will return default attribute values for missing attributes that have default values. </td></tr>
<tr class="b">
<td> noColons </td>
<td> false </td>
<td> A value of <tt>true</tt> indicates that the parser will translate colons into underscores in names. </td></tr>
<tr class="a">
<td> noRestart </td>
<td> false </td>
<td> A value of <tt>true</tt> indicates that the parser will attempt to restart the restartable elements. </td></tr>
<tr class="b">
<td> suppressIgnorableWhitespace </td>
<td> true </td>
<td> A value of <tt>false</tt> indicates that the parser will transmit whitespace in element-only content via the SAX ignorableWhitespace callback. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>convertHTML {
  charset : UTF-8
}
</pre></div>
<div class="section">
<h3>xquery<a name="xquery"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-saxon/src/main/java/com/cloudera/cdk/morphline/saxon/XQueryBuilder.java">xquery</a> command parses an InputStream that contains an XML document and runs the given <a class="externalLink" href="http://www.w3.org/TR/xquery">W3C XQuery</a> over the XML document, using the <a class="externalLink" href="http://www.saxonica.com">Saxon</a> Java library. For each item in the query result sequence, the command emits a corresponding morphline record.</p>
<p>The command reads an InputStream or byte array from the first attachment (field _attachment_body) of the input record.</p>
<p>Per the W3C specs, every valid XPath (e.g. //tweets/tweet[@color='blue']) is also a valid XQuery. If you are comfortable with XPath you are already almost there.</p>
<p>An XQuery result sequence contains zero or more items such as element nodes, attribute nodes, text nodes, atomic values, etc. For each item in the query result sequence, the morphline command converts the item to a record and pipes that record to the next morphline command. For an attribute node the attribute's <a class="externalLink" href="http://www.w3.org/TR/xquery-operators/#func-string">XPath string value</a> is filled into the record field named after the attribute name. For an element node the attributes and children of the element are treated as follows: The XPath string value of the attribute or child is filled into the record field named after the child's name.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> supportedMimeTypes </td>
<td> null </td>
<td> Optionally, require the input record to match one of the MIME types in this list. </td></tr>
<tr class="a">
<td> languageVersion </td>
<td> &quot;1.0&quot; </td>
<td> Must be <tt>&quot;1.0&quot;</tt> for XQuery 1.0 or <tt>&quot;3.0&quot;</tt> for XQuery 3.0. </td></tr>
<tr class="b">
<td> features </td>
<td> null </td>
<td> An optional JSON object containing zero or more name-value pairs that represent configuration properties for <a class="externalLink" href="http://www.saxonica.com/html/documentation/javadoc/net/sf/saxon/lib/FeatureKeys.html">Saxon features</a>. </td></tr>
<tr class="a">
<td> fragments </td>
<td> n/a </td>
<td> An array containing exactly one <i>fragment</i> JSON object, as described below. </td></tr></table>
<p>Each fragment provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<td> fragmentPath </td>
<td> n/a </td>
<td> Currently must be <tt>&quot;/&quot;</tt> </td></tr>
<tr class="b">
<td> externalVariables </td>
<td> null </td>
<td> An optional JSON object containing zero or more name-value pairs that are bound and passed in as <a class="externalLink" href="http://bit.ly/13Q82Ro">external variables</a> to the query. Example: <tt>myVar : &quot;hello world&quot;</tt> </td></tr>
<tr class="a">
<td> externalFileVariables </td>
<td> null </td>
<td> An optional JSON object containing zero or more name-path pairs that refer to XML files on the local file system, and are bound and passed in as <a class="externalLink" href="http://bit.ly/13Q82Ro">external variables</a> to the query. These files are loaded once on program startup and subsequently remain memory resident across queries. This can be used for efficient joins where the join table is static and fits into main memory. Example: <tt>myDoc : src/test/resources/testdocuments/helloworld.xml</tt> </td></tr>
<tr class="b">
<td> queryFile </td>
<td> null </td>
<td> A relative or absolute path of a local file from which to load the query. </td></tr>
<tr class="a">
<td> queryString </td>
<td> null </td>
<td> An inline string from which to load the query. One of <tt>queryFile</tt> or <tt>queryString</tt> must be present, but not both. Example: <tt>&quot;&quot;&quot;/tweets/tweet&quot;&quot;&quot;</tt> </td></tr></table>
<dl>
<dd>Note: The morphline configuration file is implemented using the HOCON format (Human Optimized Config Object Notation). HOCON is basically JSON slightly adjusted for the configuration file use case. HOCON syntax is defined at <a class="externalLink" href="http://github.com/typesafehub/config/blob/master/HOCON.md">HOCON github page</a> and as such, multi-line strings are similar to Python or Scala, using triple quotes. If the three-character sequence <tt>&quot;&quot;&quot;</tt> appears, then all Unicode characters until a closing <tt>&quot;&quot;&quot;</tt> sequence are used unmodified to create a string value.</dd></dl>
<p>Example usage:</p>
<div class="source">
<pre>xquery {
  fragments : [
    {
      fragmentPath : &quot;/&quot;
      externalVariables : {
        myVariable : &quot;hello world&quot;
      }            
      queryString : &quot;&quot;&quot;
        (: Example test xquery :)        
        
        declare variable $myVariable as xs:string external;
        
        for $tweet in /tweets/tweet
        return 
        &lt;user&gt;
          {$tweet/@id} 
          {$tweet/user/@screen_name} 
          &lt;myStatusCounts&gt;{string($tweet/user/@statuses_count)}&lt;/myStatusCounts&gt;
          &lt;text&gt;{$tweet/text}&lt;/text&gt;
          &lt;greeting&gt;{$myVariable}&lt;/greeting&gt;
        &lt;/user&gt;
      &quot;&quot;&quot;
    }
  ]
}
</pre></div>
<p>Here is an example output record for the query above:</p>
<div class="source">
<pre>id:11111112
screen_name:fake_user1
myStatusCounts:11111
text:Come, see new hot tub under Redwood Tree!
greeting:hello world
</pre></div>
<p>More examples can be found in the <a class="externalLink" href="https://github.com/cloudera/cdk/tree/master/cdk-morphlines/cdk-morphlines-saxon/src/test/resources/test-morphlines">unit tests</a>.</p>
<p>For more background, see resources such as the <a class="externalLink" href="http://www.stylusstudio.com/xquery_primer_new.html">XQuery Primer</a> and <a class="externalLink" href="http://www.stylusstudio.com/xquery_flwor.html">XQuery FLOWR Tutorial</a> and <a class="externalLink" href="http://www.datadirect.com/resources/dis/xquery-guided-tour/index.html">XQuery: A Guided Tour</a> and <a class="externalLink" href="http://en.wikipedia.org/wiki/XQuery">Wikipedia</a>.</p>
<div class="section">
<h3>xslt<a name="xslt"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-saxon/src/main/java/com/cloudera/cdk/morphline/saxon/XSLTBuilder.java">xslt</a> command parses an InputStream that contains an XML document and runs the given <a class="externalLink" href="http://www.w3.org/TR/xslt20">W3C XSL Transform</a> over the XML document, using the <a class="externalLink" href="http://www.saxonica.com">Saxon</a> Java library. For each item in the query result sequence, the command emits a corresponding morphline record.</p>
<p>The command reads an InputStream or byte array from the first attachment (field _attachment_body) of the input record.</p>
<p>An XSLT result sequence contains zero or more items such as element nodes, attribute nodes, text nodes, atomic values, etc. For each item in the query result sequence, the morphline command converts the item to a record and pipes that record to the next morphline command. For an attribute node the attribute's <a class="externalLink" href="http://www.w3.org/TR/xquery-operators/#func-string">XPath string value</a> is filled into the record field named after the attribute name. For an element node the attributes and children of the element are treated as follows: The XPath string value of the attribute or child is filled into the record field named after the child's name.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> supportedMimeTypes </td>
<td> null </td>
<td> Optionally, require the input record to match one of the MIME types in this list. </td></tr>
<tr class="a">
<td> features </td>
<td> null </td>
<td> An optional JSON object containing zero or more name-value pairs that represent configuration properties for <a class="externalLink" href="http://www.saxonica.com/html/documentation/javadoc/net/sf/saxon/lib/FeatureKeys.html">Saxon features</a>. </td></tr>
<tr class="b">
<td> fragments </td>
<td> n/a </td>
<td> An array containing exactly one <i>fragment</i> JSON object, as described below. </td></tr></table>
<p>Each fragment provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<td> fragmentPath </td>
<td> n/a </td>
<td> Currently must be <tt>&quot;/&quot;</tt> </td></tr>
<tr class="b">
<td> parameters </td>
<td> null </td>
<td> An optional JSON object containing zero or more name-value pairs that are bound and passed in as <a class="externalLink" href="http://www.w3schools.com/xsl/el_param.asp">XSLT parameters</a> to the query. Example: <tt>myVar : &quot;hello world&quot;</tt> </td></tr>
<tr class="a">
<td> fileParameters </td>
<td> null </td>
<td> An optional JSON object containing zero or more name-path pairs that refer to XML files on the local file system, and are bound and passed in as <a class="externalLink" href="http://bit.ly/13Q82Ro">external variables</a> to the query. These files are loaded once on program startup and subsequently remain memory resident across queries. This can be used for efficient joins where the join table is static and fits into main memory. Example: <tt>myDoc : src/test/resources/testdocuments/helloworld.xml</tt> </td></tr>
<tr class="b">
<td> queryFile </td>
<td> null </td>
<td> A relative or absolute path of a local file from which to load the query. </td></tr>
<tr class="a">
<td> queryString </td>
<td> null </td>
<td> An inline string from which to load the query. One of <tt>queryFile</tt> or <tt>queryString</tt> must be present, but not both. </td></tr></table>
<dl>
<dd>Note: The morphline configuration file is implemented using the HOCON format (Human Optimized Config Object Notation). HOCON is basically JSON slightly adjusted for the configuration file use case. HOCON syntax is defined at <a class="externalLink" href="http://github.com/typesafehub/config/blob/master/HOCON.md">HOCON github page</a> and as such, multi-line strings are similar to Python or Scala, using triple quotes. If the three-character sequence <tt>&quot;&quot;&quot;</tt> appears, then all Unicode characters until a closing <tt>&quot;&quot;&quot;</tt> sequence are used unmodified to create a string value.</dd></dl>
<p>Example usage:</p>
<div class="source">
<pre>xslt {
  fragments : [
    {
      fragmentPath : &quot;/&quot;
      parameters : {
        myVariable : &quot;hello world&quot;
      }            
      queryString : &quot;&quot;&quot;
        &lt;!-- Example XSLT identity transformation --&gt;
        &lt;xsl:stylesheet xmlns:xsl=&quot;http://www.w3.org/1999/XSL/Transform&quot; version=&quot;1.0&quot;&gt;
        
        &lt;xsl:template match=&quot;@*|node()&quot;&gt;
          &lt;xsl:copy&gt;
            &lt;xsl:apply-templates select=&quot;@*|node()&quot;/&gt;
          &lt;/xsl:copy&gt;
        &lt;/xsl:template&gt;
        
        &lt;/xsl:stylesheet&gt;
      &quot;&quot;&quot;
    }
  ]
}
</pre></div>
<p>More examples can be found in the <a class="externalLink" href="https://github.com/cloudera/cdk/tree/master/cdk-morphlines/cdk-morphlines-saxon/src/test/resources/test-morphlines">unit tests</a>.</p>
<p>For more background, see resources such as the <a class="externalLink" href="http://www.w3schools.com/xsl/">XSLT Tutorial</a> and <a class="externalLink" href="http://en.wikipedia.org/wiki/XSLT">Wikipedia</a>.</p>
<div class="section">
<h2>cdk-morphlines-solr-core<a name="cdk-morphlines-solr-core"></a></h2></div>
<p>This module contains morphline commands for Solr that higher level modules such as cdk-morphlines-solr-cell, search-mr, and search-flume depend on for indexing.</p>
<div class="section">
<h3>solrLocator<a name="solrLocator"></a></h3></div>
<p>A <tt>solrLocator</tt> is a set of configuration parameters that identify the location and schema of a Solr server or SolrCloud. Based on this information a morphline Solr command can fetch the Solr index schema and send data to Solr. A <tt>solrLocator</tt> is not actually a command but rather a common parameter of many morphline Solr commands, and thus described separately here.</p>
<p>Example usage:</p>
<div class="source">
<pre>solrLocator : {
  # Name of solr collection
  collection : collection1

  # ZooKeeper ensemble
  zkHost : &quot;127.0.0.1:2181/solr&quot;

  # Max number of documents to pass per RPC from morphline to Solr Server
  # batchSize : 1000
}
</pre></div>
<div class="section">
<h3>loadSolr<a name="loadSolr"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-core/src/main/java/com/cloudera/cdk/morphline/solr/LoadSolrBuilder.java">loadSolr</a> command loads a record into a Solr server or MapReduce Reducer.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> solrLocator </td>
<td> n/a </td>
<td> Solr location parameters as described separately above. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>loadSolr {
  solrLocator : {
    # Name of solr collection
    collection : collection1

    # ZooKeeper ensemble
    zkHost : &quot;127.0.0.1:2181/solr&quot;

    # Max number of docs to pass per RPC from morphline to Solr Server
    # batchSize : 1000
  }
}
</pre></div>
<div class="section">
<h3>generateSolrSequenceKey<a name="generateSolrSequenceKey"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-core/src/main/java/com/cloudera/cdk/morphline/solr/GenerateSolrSequenceKeyBuilder.java">generateSolrSequenceKey</a> command assigns a record unique key that is the concatenation of the given <tt>baseIdField</tt> record field, followed by a running count of the record number within the current session. The count is reset to zero whenever a <tt>startSession</tt> notification is received.</p>
<p>For example, assume a CSV file containing multiple records but no unique ids, and the base_id field is the filesystem path of the file. Now this command can be used to assign the following record values to Solr's unique key field: <tt>$path#0, $path#1, ... $path#N</tt>.</p>
<p>The name of the unique key field is fetched from Solr's <tt>schema.xml</tt> file, as directed by the <tt>solrLocator</tt> configuration parameter.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> solrLocator </td>
<td> n/a </td>
<td> Solr location parameters as described separately above. </td></tr>
<tr class="a">
<td> baseIdField </td>
<td> baseid </td>
<td> The name of the input field to use for prefixing keys. </td></tr>
<tr class="b">
<td> preserveExisting </td>
<td> true </td>
<td> Whether to preserve the field value if one is already present. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>generateSolrSequenceKey {
  baseIdField: ignored_base_id
  solrLocator : ${SOLR_LOCATOR}
}
</pre></div>
<div class="section">
<h3>sanitizeUnknownSolrFields<a name="sanitizeUnknownSolrFields"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-core/src/main/java/com/cloudera/cdk/morphline/solr/SanitizeUnknownSolrFieldsBuilder.java">sanitizeUnknownSolrFields</a> command sanitizes record fields that are unknown to Solr <tt>schema.xml</tt> by either deleting them (<tt>renameToPrefix</tt> parameter is absent or a zero length string) or by moving them to a field prefixed with the given <tt>renameToPrefix</tt> (for example,  to use typical dynamic Solr fields).</p>
<p>Recall that Solr throws an exception on any attempt to load a document that contains a field that is not specified in <tt>schema.xml</tt>.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> solrLocator </td>
<td> n/a </td>
<td> Solr location parameters as described separately above. </td></tr>
<tr class="a">
<td> renameToPrefix </td>
<td> &quot;&quot; </td>
<td> Output field prefix for unknown fields. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>sanitizeUnknownSolrFields {
  solrLocator : ${SOLR_LOCATOR}
}
</pre></div>
<div class="section">
<h3>tokenizeText<a name="tokenizeText"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-core/src/main/java/com/cloudera/cdk/morphline/solr/TokenizeTextBuilder.java">tokenizeText</a> command uses the embedded <a class="externalLink" href="http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters">Solr/Lucene Analyzer library</a> to generate tokens from a text string, without sending data to a Solr server.</p>
<p>This is useful for prototyping and debugging Solr applications. It is also useful for standalone usage outside of Solr, e.g. for extracting text features from documents for use with recommendation systems, clustering and classification applications.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> solrLocator </td>
<td> n/a </td>
<td> Solr location parameters as described separately above. </td></tr>
<tr class="a">
<td> inputField </td>
<td> n/a </td>
<td> The name of the input field. </td></tr>
<tr class="b">
<td> outputField </td>
<td> n/a </td>
<td> The name of the field to add output values to. </td></tr>
<tr class="a">
<td> solrFieldType </td>
<td> n/a </td>
<td> The name of the Solr field type in <tt>schema.xml</tt> to use for text analysis and tokenization. This parameter specifies the algorithmic extraction rules. Example: &quot;text_en&quot; </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>tokenizeText {
  inputField : message
  outputField : tokens
  solrFieldType : text_en
  solrLocator : {
    # Name of solr collection
    collection : collection1

    # ZooKeeper ensemble
    zkHost : &quot;127.0.0.1:2181/solr&quot;
    
    # solrHomeDir : &quot;example/solr/collection1&quot;    
  }
}
</pre></div>
<p>For example, given the input field <tt>message</tt> with the value <tt>Hello World!\nFoo@Bar.com #%()123</tt> the expected output record is:</p>
<div class="source">
<pre>tokens:hello
tokens:world
tokens:foo
tokens:bar.com
tokens:123
</pre></div>
<p>This example assumes the Solr field type named &quot;text_en&quot; is defined in <tt>schema.xml</tt> as shown in the following snippet:</p>
<div class="source">
<pre>...
&lt;fieldType name=&quot;text_en&quot; class=&quot;solr.TextField&quot; positionIncrementGap=&quot;100&quot;&gt;
  &lt;analyzer type=&quot;index&quot;&gt;
    &lt;tokenizer class=&quot;solr.StandardTokenizerFactory&quot;/&gt;
    &lt;filter class=&quot;solr.StopFilterFactory&quot;
       ignoreCase=&quot;true&quot;
       words=&quot;lang/stopwords_en.txt&quot;
       enablePositionIncrements=&quot;true&quot;
    /&gt;
    &lt;filter class=&quot;solr.LowerCaseFilterFactory&quot;/&gt;
    &lt;filter class=&quot;solr.EnglishPossessiveFilterFactory&quot;/&gt;
    &lt;filter class=&quot;solr.KeywordMarkerFilterFactory&quot; protected=&quot;protwords.txt&quot;/&gt;
    &lt;filter class=&quot;solr.PorterStemFilterFactory&quot;/&gt;
  &lt;/analyzer&gt;
&lt;/fieldType&gt;
</pre></div>
<div class="section">
<h2>cdk-morphlines-solr-cell<a name="cdk-morphlines-solr-cell"></a></h2></div>
<p>This module contains morphline commands for using SolrCell with Tika parsers. This includes support for types including HTML, XML, PDF, Word, Excel, Images, Audio, and Video.</p>
<div class="section">
<h3>solrCell<a name="solrCell"></a></h3></div>
<p>The <a class="externalLink" href="https://github.com/cloudera/cdk/blob/master/cdk-morphlines/cdk-morphlines-solr-cell/src/main/java/com/cloudera/cdk/morphline/solrcell/SolrCellBuilder.java">solrCell</a> command pipes the first attachment of a record into one of the given Tika parsers, then maps the Tika output back to a record using SolrCell.</p>
<p>The Tika parser is chosen from the configurable list of parsers, depending on the MIME type specified in the input record. Typically, this requires an upstream <tt>detectMimeType</tt> command.</p>
<p>The command provides the following configuration options:</p>
<table border="0" class="table table-striped">
<tr class="a">
<th><b> Property Name </b></th>
<th><b> Default </b></th>
<th><b> Description </b></th></tr>
<tr class="b">
<td> solrLocator </td>
<td> n/a </td>
<td> Solr location parameters as described separately above. </td></tr>
<tr class="a">
<td> capture </td>
<td> [] </td>
<td> List of XHTML element names to extract from the Tika output. For instance, it could be used to grab paragraphs (&lt;p&gt;) and index them into a separate field. Note that content is also still captured into the overall &quot;content&quot; field. </td></tr>
<tr class="b">
<td> fmaps </td>
<td> [] </td>
<td> Maps (moves) one field name to another. See the example below. </td></tr>
<tr class="a">
<td> uprefix </td>
<td> null </td>
<td> The <tt>uprefix</tt> option indicates that the command shall prefix all fields that are not defined in the Solr <tt>schema.xml</tt> with the given prefix. Recall that Solr throws an exception on any attempt to load a document that contains a field that is not specified in <tt>schema.xml</tt>. The <tt>uprefix</tt> option is very useful when combined with dynamic field definitions. For example, <tt>uprefix : ignored</tt>_ would effectively ignore all unknown fields generated by Tika if the <tt>schema.xml</tt> contains the following dynamic field definition: <tt>dynamicField name=&quot;ignored</tt>_*&quot; <tt>type=&quot;ignored&quot;</tt> </td></tr>
<tr class="b">
<td> captureAttr </td>
<td> false </td>
<td> Whether to index attributes of the Tika XHTML elements into separate fields, named after the element. For example, when extracting from HTML, Tika can return the href attributes in <tt>&lt;a&gt;</tt> tags as fields named &quot;a&quot;. </td></tr>
<tr class="a">
<td> xpath </td>
<td> null </td>
<td> When extracting, only return Tika XHTML content that satisfies the XPath expression. See <a class="externalLink" href="http://tika.apache.org/1.2/parser.html">http://tika.apache.org/1.2/parser.html</a> for details on the format of Tika XHTML. See also <a class="externalLink" href="http://wiki.apache.org/solr/TikaExtractOnlyExampleOutput">http://wiki.apache.org/solr/TikaExtractOnlyExampleOutput</a>. </td></tr>
<tr class="b">
<td> lowernames </td>
<td> false </td>
<td> Map all field names to lowercase with underscores. For example, ContentType would be mapped to contenttype. </td></tr>
<tr class="a">
<td> solrContentHandlerFactory </td>
<td> com.cloudera.cdk.morphline.morphline.solrcell.TrimSolrContentHandlerFactory </td>
<td> A Java class to handle bridging from Tika to SolrCell. </td></tr>
<tr class="b">
<td> parsers </td>
<td> [] </td>
<td> List of fully qualified Java class names of one or more Tika parsers. </td></tr></table>
<p>Example usage:</p>
<div class="source">
<pre>solrCell {
  solrLocator : ${SOLR_LOCATOR}

  # extract some fields
  capture : [content, a, h1, h2]

  # rename exif_image_height field to text field
  # rename a field to anchor field
  # rename h1 field to heading1 field
  fmap : { exif_image_height : text, a : anchor, h1 : heading1 }

  # xpath : &quot;/xhtml:html/xhtml:body/xhtml:div/descendant:node()&quot;

  parsers : [ # one or more nested Tika parsers
    { parser : org.apache.tika.parser.jpeg.JpegParser }
  ]
}
</pre></div>
<p>Here is a complex morphline that demonstrates integrating multiple heterogenous input file formats via a <tt>tryRules</tt> command, including Avro and SolrCell, using auto detection of MIME types via <tt>detectMimeType</tt> command, recursion via the <tt>callParentPipe</tt> command for unwrapping container formats, and automatic UUID generation:</p>
<div class="source">
<pre>morphlines : [
  {
    id : morphline1
    importCommands : [&quot;com.cloudera.**&quot;, &quot;org.apache.solr.**&quot;]

    commands : [
      {
        # emit one output record for each attachment in the input
        # record's list of attachments. The result is a list of
        # records, each of which has at most one attachment.
        separateAttachments {}
      }

      {
        # used for auto-detection if MIME type isn't explicitly supplied
        detectMimeType {
          includeDefaultMimeTypes : true
          mimeTypesFiles : [target/test-classes/custom-mimetypes.xml]
        }
      }

      {
        tryRules {
          throwExceptionIfAllRulesFailed : true
          rules : [
            # next rule of tryRules cmd:
            {
              commands : [
                { logDebug { format : &quot;hello unpack&quot; } }
                { unpack {} }
                { generateUUID {} }
                { callParentPipe {} }
              ]
            }

            # next rule of tryRules cmd:
            {
              commands : [
                { logDebug { format : &quot;hello decompress&quot; } }
                { decompress {} }
                { callParentPipe {} }
              ]
            }

            # next rule of tryRules cmd:
            {
              commands : [
                {
                  readAvroContainer {
                    supportedMimeTypes : [avro/binary]
                    # optional, avro json schema blurb for getSchema()
                    # readerSchemaString : &quot;&lt;json can go here&gt;&quot;
                    # readerSchemaFile : /path/to/syslog.avsc
                  }
                }

                { extractAvroTree {} }

                {
                  setValues {
                    id : &quot;@{/id}&quot;
                    user_screen_name : &quot;@{/user_screen_name}&quot;
                    text : &quot;@{/text}&quot;
                  }
                }

                {
                  sanitizeUnknownSolrFields {
                    solrLocator : ${SOLR_LOCATOR}
                  }
                }
              ]
            }

            # next rule of tryRules cmd:
            {
              commands : [
                {
                  readJsonTestTweets {
                    supportedMimeTypes : [&quot;mytwittertest/json+delimited+length&quot;]
                  }
                }

                {
                  sanitizeUnknownSolrFields {
                    solrLocator : ${SOLR_LOCATOR}
                  }
                }
              ]
            }

            # next rule of tryRules cmd:
            {
              commands : [
                { logDebug { format : &quot;hello solrcell&quot; } }
                {
                  # wrap SolrCell around an Tika parsers
                  solrCell {
                    solrLocator : ${SOLR_LOCATOR}

                    capture : [
                      # twitter feed schema
                      user_friends_count
                      user_location
                      user_description
                      user_statuses_count
                      user_followers_count
                      user_name
                      user_screen_name
                      created_at
                      text
                      retweet_count
                      retweeted
                      in_reply_to_user_id
                      source
                      in_reply_to_status_id
                      media_url_https
                      expanded_url
                     ]

                    # rename &quot;content&quot; field to &quot;text&quot; fields
                    fmap : { content : text, content-type : content_type }

                    lowernames : true

                    # Tika parsers to be registered:
                    parsers : [
                      { parser : org.apache.tika.parser.asm.ClassParser }
                      { parser : org.gagravarr.tika.FlacParser }
                      { parser : org.apache.tika.parser.audio.AudioParser }
                      { parser : org.apache.tika.parser.audio.MidiParser }
                      { parser : org.apache.tika.parser.crypto.Pkcs7Parser }
                      { parser : org.apache.tika.parser.dwg.DWGParser }
                      { parser : org.apache.tika.parser.epub.EpubParser }
                      { parser : org.apache.tika.parser.executable.ExecutableParser }
                      { parser : org.apache.tika.parser.feed.FeedParser }
                      { parser : org.apache.tika.parser.font.AdobeFontMetricParser }
                      { parser : org.apache.tika.parser.font.TrueTypeParser }
                      { parser : org.apache.tika.parser.xml.XMLParser }
                      { parser : org.apache.tika.parser.html.HtmlParser }
                      { parser : org.apache.tika.parser.image.ImageParser }
                      { parser : org.apache.tika.parser.image.PSDParser }
                      { parser : org.apache.tika.parser.image.TiffParser }
                      { parser : org.apache.tika.parser.iptc.IptcAnpaParser }
                      { parser : org.apache.tika.parser.iwork.IWorkPackageParser }
                      { parser : org.apache.tika.parser.jpeg.JpegParser }
                      { parser : org.apache.tika.parser.mail.RFC822Parser }
                      { parser : org.apache.tika.parser.mbox.MboxParser,
                          additionalSupportedMimeTypes : [message/x-emlx] }
                      { parser : org.apache.tika.parser.microsoft.OfficeParser }
                      { parser : org.apache.tika.parser.microsoft.TNEFParser }
                      { parser : org.apache.tika.parser.microsoft.ooxml.OOXMLParser }
                      { parser : org.apache.tika.parser.mp3.Mp3Parser }
                      { parser : org.apache.tika.parser.mp4.MP4Parser }
                      { parser : org.apache.tika.parser.hdf.HDFParser }
                      { parser : org.apache.tika.parser.netcdf.NetCDFParser }
                      { parser : org.apache.tika.parser.odf.OpenDocumentParser }
                      { parser : org.apache.tika.parser.pdf.PDFParser }
                      { parser : org.apache.tika.parser.pkg.CompressorParser }
                      { parser : org.apache.tika.parser.pkg.PackageParser }
                      { parser : org.apache.tika.parser.rtf.RTFParser }
                      { parser : org.apache.tika.parser.txt.TXTParser }
                      { parser : org.apache.tika.parser.video.FLVParser }
                      { parser : org.apache.tika.parser.xml.DcXMLParser }
                      { parser : org.apache.tika.parser.xml.FictionBookParser }
                      { parser : org.apache.tika.parser.chm.ChmParser }
                    ]
                  }
                }

                { generateUUID { field : ignored_base_id } }

                {
                  generateSolrSequenceKey {
                    baseIdField: ignored_base_id
                    solrLocator : ${SOLR_LOCATOR}
                  }
                }

              ]
            }
          ]
        }
      }

      {
        loadSolr {
          solrLocator : ${SOLR_LOCATOR}
        }
      }

      {
        logDebug {
          format : &quot;My output record: {}&quot;
          args : [&quot;@{}&quot;]
        }
      }

    ]
  }
]
</pre></div>
<dl>
<dd>Note: More information on SolrCell can be found here: <a class="externalLink" href="http://wiki.apache.org/solr/ExtractingRequestHandler">http://wiki.apache.org/solr/ExtractingRequestHandler</a></dd></dl>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2013
                        <a href="http://www.cloudera.com">Cloudera</a>.
            All Rights Reserved.      
                    
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
