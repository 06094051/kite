<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Using Kite Properties</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="An open source data API for Hadoop.">
    <link rel="canonical" href="http://kitesdk.org/docs/staging/using-kite-properties.html">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/docs/staging/css/main.css">
    <link href='http://fonts.googleapis.com/css?family=Raleway:200,400,500,600,700' rel='stylesheet' type='text/css'>
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

</head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/docs/staging/">Kite Software Development Kit</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
    </nav>

  </div>

</header>


    <div class="page-content">
      
      <div class="sidebar">
      
        <h4>About Kite</h4>
        <ul>
          
        </ul>
      
        <h4></h4>
        <ul>
          
          
          <li><a href="/docs/staging/Kite-SDK-Guide.html">Kite Background</a></li>
          
          
          
          <li><a href="/docs/staging/Kite-Data-Module-Overview.html">Datasets Overview</a></li>
          
          
        </ul>
      
        <h4>Kite CLI</h4>
        <ul>
          
          
          <li><a href="/docs/staging/Install-Kite.html">Installing the CLI</a></li>
          
          
          
          <li><a href="/docs/staging/Using-the-Kite-CLI-to-Create-a-Dataset.html">Importing CSV data</a></li>
          
          
          
          <li><a href="/docs/staging/cli-reference.html">Kite CLI Reference</a></li>
          
          
        </ul>
      
        <h4>Kite API</h4>
        <ul>
          
          
          <li><a href="/docs/staging/API-Overview.html">API Introduction</a></li>
          
          
          
          <li><a href="/docs/staging/view-api.html">Views API</a></li>
          
          
          
          <li><a href="/docs/staging/Using-Kite-with-Apache-Maven.html">Using Kite with Maven</a></li>
          
          
        </ul>
      
        <h4>Reference</h4>
        <ul>
          
          
          <li><a href="/docs/staging/URIs.html">Kite URIs</a></li>
          
          
          
          <li><a href="/docs/staging/Schema-Evolution.html">Schema Evolution</a></li>
          
          
          
          <li><a href="/docs/staging/Partitioned-Datasets.html">Partitioned Datasets</a></li>
          
          
          
          <li><a href="/docs/staging/Parquet-vs-Avro-Format.html">Parquet vs Avro</a></li>
          
          
          
          <li><a href="/docs/staging/HBase-Storage-Cells.html">HBase Storage</a></li>
          
          
          
          <li><a href="/docs/staging/Column-Mapping.html">Column Mapping</a></li>
          
          
          
          <li><a href="/docs/staging/lifecycle.html">Dataset Lifecycle</a></li>
          
          
          
          <li><a href="/docs/staging/maven">Maven Plugin</a></li>
          
          
          
          <li><a href="/docs/staging/dependencies">Dependency Info</a></li>
          
          
        </ul>
      
      </div>
      

      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>Using Kite Properties</h1>
  </header>

  <article class="post-content">
  <p>Kite gives you the option of changing settings of existing system properties to enhance performance. You also have the option of creating custom properties for additional control over how Kite reads or writes your data.</p>

<h2 id="setting-kite-properties">Setting Kite Properties</h2>

<p>There are several dataset properties that affect how files are written. These settings are especially relevant for Parquet, because it buffers records in memory. </p>

<p>You can set properties on your datasets with <a href="/docs/staging/apidocs/org/kitesdk/data/DatasetDescriptor.Builder.html#property(java.lang.String,%20java.lang.String)"><code>DatasetDescriptor.Builder.property</code></a> when using the API, or with the <code>--set</code> option from the Kite CLI.</p>

<h3 id="kitewritercache-size">kite.writer.cache-size</h3>

<p><code>kite.writer.cache-size</code> controls the number of files kept open by an HDFS or Hive dataset writer. The default cache size is 10.</p>

<p>Writers open one file per partition to which they write records. When the writer receives a record that goes in a new partition (one for which there isn’t an open file) it creates a new file in that partition. If the number of open files exceeds the cache size, Kite closes the file that was used least recently.</p>

<p>For some applications, adjusting the writer cache size can improve performance. For example, you might have an application writing a year’s worth of data to year/month partitions. There are 12 partitions, but, by default, only 10 files are open at the same time. The application must constantly close and open files, which slows down your writes. If you increase the writer cache to 12, files for all 12 months are open at once. To increase the writer cache size, you can use the CLI <code>update</code> command.</p>

<pre><code>kite-dataset update dataset:hdfs:/user/me/datasets/annual_earnings --set kite.writer.cache-size=12
</code></pre>

<h3 id="parquetblocksize">parquet.block.size</h3>

<p>Kite passes descriptor properties to the underlying file formats. For example, Parquet defines <code>parquet.block.size</code>, which is approximately the amount of data that is buffered before writing a group of records (a <em>row group</em>). <code>parquet.block.size</code> defaults to 128MB.</p>

<h4 id="avoiding-parquet-outofmemory-exceptions">Avoiding Parquet OutOfMemory Exceptions</h4>

<p>The amount of data kept in memory for each file could be up to the Parquet block size in bytes. That means that the upper bound for a writer’s memory consumption is <code>parquet.block.size</code> multiplied by the <code>kite.writer.cache-size</code>. It is important that this number doesn’t exceed a reasonable portion of the heap memory allocated to the process, or else the write could fail with an <code>OutOfMemoryException</code>.</p>

<p>The recommended way to avoid out of memory exceptions is to write to fewer files. When working with Crunch, you can use <a href="/docs/staging/apidocs/org/kitesdk/data/crunch/CrunchDatasets.html#partition(org.apache.crunch.PCollection,%20org.kitesdk.data.Dataset)">CrunchDatasets.partition</a> methods to restructure data so that all of the records stored in a given partition are processed by the same writer.</p>

<h2 id="creating-custom-properties">Creating Custom Properties</h2>

<p>In addition to setting existing system properties, you can create your own key-value pairs to use as custom properties in your application.</p>

<p>When using the  CLI <a href="/docs/staging/cli-reference.html#create"><code>create</code></a> or <a href="/docs/staging/cli-reference.html#update"><code>update</code></a> commands, you add custom properties with the option <code>--set prop.name=value</code>.</p>

<p>When using the Kite API, you can add properties using <a href="/docs/staging/apidocs/org/kitesdk/data/DatasetDescriptor.Builder.html#property(java.lang.String,%20java.lang.String)">DatasetDescriptor.Builder.property</a>.</p>


  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap columns">

    <div class="left">
      <h2 class="footer-heading">Kite Software Development Kit, 1.0.0</h2>

      <ul>
        <li>Kite is licensed under</li>
        <li><a href="http://www.apache.org/licenses/LICENSE-2.0.html">The Apache License, Version 2.0</a></li>
        <li>&nbsp;</li>
        <li>Generated on 24 February 2015</li>
      </ul>

    </div>

    <div class="middle">
    </div>

    <div class="right">
      <p class="text">An open source data API for Hadoop.
        <div class="columns">
          <div class="left">
            <ul>
              <li><a href="https://github.com/kite-sdk/kite"><i class="fa fa-github fa-lg"></i>&nbsp; Source</a></li>
              <li><a href="https://issues.cloudera.org/browse/CDK"><i class="fa fa-bug fa-lg"></i>&nbsp; Issue tracking</a></li>
              <li><a href="https://groups.google.com/a/cloudera.org/forum/#!forum/cdk-dev"><i class="fa fa-comments-o fa-lg"></i>&nbsp; Mailing list</a></li>
              <li><a href="https://github.com/kite-sdk/kite/wiki/How-to-contribute"><i class="fa fa-cogs fa-lg"></i>&nbsp; How to contribute</a></li>
            </ul>
          </div>
          <div class="right">
            <ul>
              <li><a href="https://github.com/kite-sdk/kite-examples"><i class="fa fa-play"></i>&nbsp; Examples</a></li>
              <li><a href="/docs/1.0.0/apidocs/index.html"><i class="fa fa-file-text-o"></i>&nbsp; API Javadoc</a></li>
              <li><a href="/docs/1.0.0/jdiff/changes.html"><i class="fa fa-bolt fs-lg"></i>&nbsp; API Changes</a></li>
              <li><a href="/docs/staging/release-notes"><i class="fa fa-info fa-lg"></i>&nbsp; Release Notes</a></li>
            </ul>
          </div>
        </div>
      </p>
    </div>

  </div>

</footer>


    </body>
</html>
