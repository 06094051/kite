
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2014-05-13
 Rendered using Maven Reflow Skin 1.0.0 (http://andriusvelykis.github.com/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Kite - Data Module Overview</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap.min.css" rel="stylesheet" />
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="./css/docs.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />
		
		<link href="http://yandex.st/highlightjs/7.3/styles/github.min.css" rel="stylesheet" />
		
		<link href="./css/lightbox.css" rel="stylesheet" />
		
		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />
		
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->

	</head>

	<body class="page-overview project-kite-parent" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<div class="brand">Kite Software Development Kit</div>
					<div class="nav-collapse">
						<ul class="nav pull-right">
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Main <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="index.html" title="Home">Home </a></li>
									<li><a href="release_notes.html" title="Release Notes">Release Notes </a></li>
									<li><a href="apidocs/index.html" title="Javadoc">Javadoc </a></li>
									<li><a href="jdiff/changes.html" title="API Diffs">API Diffs </a></li>
									<li><a href="dependencies.html" title="Dependency Information">Dependency Information </a></li>
									<li><a href="migrating.html" title="Migrating from CDK">Migrating from CDK </a></li>
									<li><a href="http://github.com/kite-sdk/kite-examples" title="Examples" class="externalLink">Examples </a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Modules <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="kite-data/index.html" title="Kite Data">Kite Data </a></li>
									<li><a href="kite-maven-plugin/index.html" title="Kite Maven Plugin">Kite Maven Plugin </a></li>
									<li><a href="kite-morphlines/index.html" title="Kite Morphlines">Kite Morphlines </a></li>
									<li><a href="kite-tools/index.html" title="Kite Tools">Kite Tools </a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Contribute <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="http://github.com/kite-sdk/kite" title="Source Repository" class="externalLink">Source Repository </a></li>
									<li><a href="https://issues.cloudera.org/browse/CDK" title="JIRA" class="externalLink">JIRA </a></li>
									<li><a href="https://groups.google.com/a/cloudera.org/forum/#!forum/cdk-dev" title="Mailing List" class="externalLink">Mailing List </a></li>
									<li><a href="how_to_contribute.html" title="How To Contribute">How To Contribute </a></li>
									<li><a href="adding_a_module.html" title="Adding a Module">Adding a Module </a></li>
									<li><a href="project-info.html" title="Project Information">Project Information </a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		
	<div class="container">
	
	<!-- Masthead
	================================================== -->
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
<div class="page-header">
 <h1>Data Module Overview</h1>
</div> 
<p>The Kite Data module is a set of APIs for interacting with data in Hadoop, specifically direct reading and writing of datasets in storage subsystems such as the Hadoop Distributed FileSystem (HDFS).</p> 
<p>These APIs do not replace or supersede any of the existing Hadoop APIs. Instead, the Data module streamlines application of those APIs. You still use HDFS and Avro APIs directly when needed. The Kite Data module reflects best practices for default choices, data organization, and metadata system integration.</p> 
<p>The Data module makes specific design choices that guide you toward well known patterns that make sense for most use cases. If you have advanced or niche use cases, this module might not be the best choice.</p> 
<p>Limiting your options is not the goal. The Kite Data module is designed to be immediately useful, obvious, and in line with what most users do most frequently. Whenever revealing an option creates complexity, or otherwise requires you to research and assess additional choices, the option is omitted.</p> 
<p>These APIs easily fit in with dependency injection frameworks such as Spring and Google Guice. You can use constructor injection when using these kinds of systems. Alternatively, if you prefer not to use DI frameworks, you can use the builder-style helper classes that come with many of the critical classes. By convention, these builders are always inner static classes named Builder, contained within their constituent classes.</p> 
<p>The primary actors in the Data module are:</p> 
<ul> 
 <li>entities</li> 
 <li>schemas</li> 
 <li>datasets</li> 
 <li>partitioning strategies</li> 
 <li>dataset descriptors</li> 
 <li>dataset repositories</li> 
</ul> 
<p>Many of these objects are interfaces, permitting multiple implementations, each with different functionality. The current release contains an implementation of each of these components for the Hadoop FileSystem abstraction (found in the org.kitesdk.data.filesystem package), for Hive (found in the org.kitesdk.data.hcatalog package), and for HBase (see the section about Dataset Repository URIs for how to access it).</p> 
<p>While, in theory, any implementation of Hadoopâ€™s FileSystem abstract class is supported by the Kite Data module, only the local and HDFS filesystem implementations are tested and officially supported.</p> 
<div class="section"> 
 <h2 id="Entities">Entities</h2> 
 <p>An entity is a single record in a dataset. The name <i>entity</i> is a better term than <i>record</i>, because <i>record</i> sounds as if it is a simple list of primitives, while <i>entity</i> sounds more like a Plain Old Java Object, or POJO, (see <a class="externalLink" href="http://en.wikipedia.org/wiki/Plain_Old_Java_Object">POJO</a> in Wikipedia) that could contain maps, lists, or other POJOs. That said, <i>entity</i> and <i>record</i> are often used interchangeably when talking about datasets. </p> 
 <p>Entities can be simple types, representing data structures with a few string attributes, or as complex as required.</p> 
 <p>Best practices are to define the output for your system, identifying all of the field values required to produce the report or analytics results you need. Once you identify your required fields, you define one or more related entities where you store the information you need to create your output. Define the format and structure for your entities using a schema.</p> 
</div> 
<div class="section"> 
 <h2 id="Schemas">Schemas</h2> 
 <p>A schema defines the field names and datatypes for a dataset. Kite relies on an Apache Avro schema definition for each dataset. For example, this is the schema definition for a table listing movies from the <tt>movies.csv</tt> dataset.<sup>1</sup></p> 
 <div class="source"> 
  <pre>{
  &quot;type&quot;:&quot;record&quot;,
  &quot;name&quot;:&quot;Movie&quot;,
  &quot;namespace&quot;:&quot;org.kitesdk.examples.data&quot;,
  &quot;fields&quot;:[
    {&quot;name&quot;:&quot;id&quot;,&quot;type&quot;:&quot;int&quot;},
    {&quot;name&quot;:&quot;title&quot;,&quot;type&quot;:&quot;string&quot;},
    {&quot;name&quot;:&quot;releaseDate&quot;,&quot;type&quot;:&quot;string&quot;},
    {&quot;name&quot;:&quot;imdbUrl&quot;,&quot;type&quot;:&quot;string&quot;}
  ]
}
</pre> 
 </div> 
 <p>The goal is to get the schema into the <tt>.avsc</tt> format and store it in the Hadoop file system. There are several ways to get the schema into the correct format. The following links provide examples for some of these approaches.</p> 
 <table border="0" class="bodyTable table table-striped table-hover"> 
  <thead> 
   <tr class="a"> 
    <th>Java API </th> 
    <th>Command Line Interface</th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr class="b"> 
    <td><a href="inferschemafromobject.html">Inferring a schema from a Java class</a> </td> 
    <td><a href="kitedatasetcli.html#objSchema">Inferring a schema from a Java class.</a></td> 
   </tr> 
   <tr class="a"> 
    <td><a href="inferschemafromavro.html">Using the schema of an Avro data file</a> </td> 
    <td><a href="kitedatasetcli.html#csvSchema">Inferring a schema from a CSV file.</a></td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<div class="section"> 
 <h2 id="Datasets">Datasets</h2> 
 <p>A dataset is a collection of zero or more entities, represented by the interface Dataset. The relational database analog of a dataset is a table.</p> 
 <p>The HDFS implementation of a dataset is stored as Snappy-compressed Avro data files by default. The HDFS implementation is made up of zero or more files in a directory. You also have the option of storing your dataset in the column-oriented Parquet file format.</p> 
 <p>You can work with a subset of dataset entities using the Views API.</p> 
 <div class="section"> 
  <h3 id="Dataset_Descriptor">Dataset Descriptor</h3> 
  <p>All datasets have a name and an associated dataset descriptor. The dataset descriptor describes all aspects of the dataset. Primarily, the descriptor information is the datasetâ€™s required schema and format. It might also store the dataset location (a repository URI) and a partition strategy. You must provide a descriptor at the time you create a dataset. You define the schema using Avro Schema APIs.</p> 
  <p>Entities must all conform to the same schema.</p> 
  <p>Datasets are represented by the <tt>org.kitesdk.data.Dataset</tt> interface. The parameters of <tt>Dataset</tt> correspond to the Java type of the entities it is used to read and write.</p> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Partitioned_Datasets">Partitioned Datasets</h2> 
 <p>You can partition your dataset on one or more attributes of an entity. Proper partitioning helps hadoop store information for improved performance. You can partition your records using hash, identity, or date (year, month, day, hour) strategies.</p> 
 <p>Imagine that you are working the registration desk at a conference. There are 100 attendees. You might decide you can hand out the name badges more efficiently if you have two lines that distribute the badges alphabetically, from A-M and N-Z. The attendee knows to go to one line or the other. The conference worker at the N-Z station doesn't bother looking through the badges A-M, because she knows that the attendee is going to be in her set of badges. It's more efficient, because she only has to search half of the items to find the right one.</p> 
 <p>However, that assumes that there is an equal distribution of names across all letters of the alphabet. It could be that there just happen to be an unusually high number of attendees whose names start with &quot;B,&quot; resulting in long waits in the first line and little activity in the second line. Breaking out into three tables, A-I, J-S, T-Z might provide greater efficiency, sharing the workload and reducing the search time at any one table.</p> 
 <p>Fastest of all might be to have 100 stations where each individual could pick up her badge, but that would be a waste of time and effort for most of the staff. There is a &quot;sweet spot&quot; that maximizes efficiency with minimal resources.</p> 
 <p>When you store records in HDFS, the data is stored in &quot;partitions&quot; that provide coarse-grained organization. You can improve performance by providing hints to the system using a partitioning strategy. For example, if you most often retrieve your data using time-based queries, you can define the partitioning strategy by year, month, day, and hour, depending on the frequency with which you're capturing data. Your queries will run more quickly if the buckets used to organize your data correspond with the types of queries you make most often.</p> 
</div> 
<div class="section"> 
 <h2 id="Defining_a_Partitioning_Strategy">Defining a Partitioning Strategy</h2> 
 <p>Partitioning strategies are described in JSON format. You have the option of providing a partitioning strategy when you first create a dataset (you cannot apply a partitioning strategy to an existing dataset after you create it).</p> 
 <p>For example, here is a schema for a dataset that keeps track of visitors to a casino who belong to a loyalty club called the &quot;High Rollers.&quot; The dataset stores information about their activity them UserID, recording when they enter the casino and how long they stay each time they visit.</p> 
 <div class="section"> 
  <div class="section"> 
   <h4 id="HighRollers.avsc">HighRollers.avsc</h4> 
   <div class="source"> 
    <pre>{
  &quot;type&quot; : &quot;record&quot;,
  &quot;name&quot; : &quot;HighRollersClub&quot;,
  &quot;doc&quot; : &quot;Schema generated by Kite&quot;,
  &quot;fields&quot; : [ {
    &quot;name&quot; : &quot;UserID&quot;,
    &quot;type&quot; : [ &quot;null&quot;, &quot;long&quot; ],
    &quot;doc&quot; : &quot;Unique customer identifier.&quot;
  }, {
    &quot;name&quot; : &quot;EntryTime&quot;,
    &quot;type&quot; : &quot;long&quot;,
    &quot;doc&quot; : &quot;Timestamp at entry in milliseconds since Unix epoch&quot;
  }, {
    &quot;name&quot; : &quot;Duration&quot;,
    &quot;type&quot; : [ &quot;null&quot;, &quot;long&quot; ],
    &quot;doc&quot; : &quot;Time interval in milliseconds&quot;
  } ]
}
</pre> 
   </div> 
   <p>Since the most common query against this data is time-based, you can define a partitioning strategy that gives Hadoop a hint that it should partition the information by year, month, and day. The partitioning strategy looks like this.</p> 
  </div> 
  <div class="section"> 
   <h4 id="HighRollers.json">HighRollers.json</h4> 
   <div class="source"> 
    <pre>[ {
  &quot;source&quot; : &quot;EntryTime&quot;,
  &quot;type&quot; : &quot;year&quot;,
  &quot;name&quot; : &quot;year&quot;
}, {
  &quot;source&quot; : &quot;EntryTime&quot;,
  &quot;type&quot; : &quot;month&quot;,
  &quot;name&quot; : &quot;month&quot;
}, {
  &quot;source&quot; : &quot;EntryTime&quot;,
  &quot;type&quot; : &quot;day&quot;,
  &quot;name&quot; : &quot;day&quot;
} ]
</pre> 
   </div> 
   <p>You can also use the command line interface command <tt>partition-config</tt> to generate the JSON file. See <a href="kitedatasetcli.html#partition-config">partition-config</a>.</p> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Creating_a_Dataset_That_Uses_a_Partition_Strategy">Creating a Dataset That Uses a Partition Strategy</h3> 
  <p>When you create a new dataset, you can specify the partition strategy along with the schema in the command line arguments. You can apply a partition strategy only when creating the dataset. You cannot apply a partition strategy to an existing dataset.</p> 
  <p>For example, you can create a dataset for our HighRollers club using this command.</p> 
  <div class="source"> 
   <pre>dataset create HighRollersClub -s HighRollers.avsc -p HighRollers.json 
</pre> 
  </div> 
  <p>See <a href="kitedatasetcli.html#create">create</a> for more options when creating a dataset. You can also use Kite to manage datasets in HBase, using the same tools and APIs. HBase datasets work differently than datasets backed by files in HDFS in two ways. First, dataset partitioning is handled by HBase and configuring it is a little different. Second, HBase stores data as a group of values, or cells, so you will need to configure how Kite divides your records into separate cells.</p> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Background:_HBase_storage_cells">Background: HBase storage cells</h2> 
 <p>HBase stores data as a group of values, or cells, uniquely identified by a key. Using a key, you can look up the data for records stored in HBase very quickly, and also insert, modify, or delete records in the middle of a dataset. HBase makes this possible by keeping data organized by storage key.</p> 
 <p>While HDFS writes files into statically configured partitions, HBase dynamically groups keys, as needed, into files. When a group of records (a <b>region</b>) grows too large, HBase splits it into two regions. As more data is added, regions grow more specific, and the boundary between regions could be between any two keys.</p> 
 <p>Data cells are organized by column family, and then column qualifier. The cells form columns and groups of columns in a table structure. For example, a user's data can be stored using the e-mail address for a key, then a &quot;name&quot; column family with &quot;first&quot; and &quot;last&quot; qualifiers. We end up with a view that looks like this:</p> 
 <div class="source"> 
  <pre>|  key           |  name (family)    |
| (e-mail)       | first | last      |
| -------------- | ----- | --------- |
| buzz@pixar.com | Buzz  | Lightyear |
</pre> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="HBase_partitioning">HBase partitioning</h2> 
 <p>Kite uses a dataset's partitioning strategy to make storage keys for records. In HDFS, the key identifies a directory where the record is stored along with others with the same key (for example, events that happened on the same day). In HBase, keys are unique, making it very fast to find a particular record. A key in HBase might be an ID number or an e-mail address, as in the example above.</p> 
 <p>When configuring a partitioning strategy for HBase, always include a field that uniquely identifies the record.</p> 
 <div class="section"> 
  <h3 id="Organizing_data">Organizing data</h3> 
  <p>Good performance comes from being able to ignore as much of a dataset as possible. HBase partitioning works just like HDFS, even though you don't know where the partition boundaries are. The same guidelines for performance still apply: your partitioning strategy should start with information that helps eliminate the most data.</p> 
  <p>For example, storing events in HDFS by year, then month, and then day, allows Kite to ignore files that can't have data in a given time range. A similar partition strategy for HBase would include the entire timestamp, because the region boundaries are not statically set ahead of time and might be small.</p> 
  <h1>Dataset Repository</h1> 
  <p>A <i>dataset repository</i> is a physical storage location for datasets. Keeping with the relational database analogy, a dataset repository is the equivalent of a database of tables.</p> 
  <p>You can organize datasets into different dataset repositories for reasons related to logical grouping, security and access control, backup policies, and so on.</p> 
  <p>A dataset repository is represented by instances of the <tt>org.kitesdk.data.DatasetRepository</tt> interface in the Kite Data module. An instance of <tt>DatasetRepository</tt> acts as a factory for datasets, supplying methods for creating, loading, and deleting datasets.</p> 
  <p>Each dataset belongs to exactly one dataset repository. Kite doesn't provide built-in support for moving or copying datasets between repositories. MapReduce and other execution engines provide copy functionality, if you need it.</p> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Loading_data_from_CSV">Loading data from CSV</h2> 
 <p>You can load comma separated value data into a dataset repository using the command line interface function <a href="kitedatasetcli.html#csvImport">csv-import</a>. </p> 
 <h1>Viewing Your Data</h1> 
 <p>Datasets you create Kite are no different than any other Hadoop dataset in your system, once created. You can query the data with Hive or view it using Impala.</p> 
 <p>For quick verification that your data has loaded properly, you can view the top <i>n</i> records in your dataset using the command line interface function <a href="kitedatasetcli.html#show">show</a>.</p> 
 <hr /> 
 <ol style="list-style-type: decimal"> 
  <li>The MovieLens data set was created by the GroupLens Research Group at the University of Minnesota and is available at <a class="externalLink" href="http://grouplens.org/datasets/movielens/"> </a><a class="externalLink" href="http://grouplens.org/datasets/movielens/">http://grouplens.org/datasets/movielens/</a> .</li> 
 </ol> 
</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->
	
	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li>
							<a href="index.html" title="Home">Home </a>
						</li>
						<li>
							<a href="release_notes.html" title="Release Notes">Release Notes </a>
						</li>
						<li>
							<a href="apidocs/index.html" title="Javadoc">Javadoc </a>
						</li>
						<li>
							<a href="jdiff/changes.html" title="API Diffs">API Diffs </a>
						</li>
						<li>
							<a href="dependencies.html" title="Dependency Information">Dependency Information </a>
						</li>
						<li>
							<a href="migrating.html" title="Migrating from CDK">Migrating from CDK </a>
						</li>
						<li>
							<a href="http://github.com/kite-sdk/kite-examples" title="Examples" class="externalLink">Examples </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Modules</li>
						<li>
							<a href="kite-data/index.html" title="Kite Data">Kite Data </a>
						</li>
						<li>
							<a href="kite-maven-plugin/index.html" title="Kite Maven Plugin">Kite Maven Plugin </a>
						</li>
						<li>
							<a href="kite-morphlines/index.html" title="Kite Morphlines">Kite Morphlines </a>
						</li>
						<li>
							<a href="kite-tools/index.html" title="Kite Tools">Kite Tools </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Contribute</li>
						<li>
							<a href="http://github.com/kite-sdk/kite" title="Source Repository" class="externalLink">Source Repository </a>
						</li>
						<li>
							<a href="https://issues.cloudera.org/browse/CDK" title="JIRA" class="externalLink">JIRA </a>
						</li>
						<li>
							<a href="https://groups.google.com/a/cloudera.org/forum/#!forum/cdk-dev" title="Mailing List" class="externalLink">Mailing List </a>
						</li>
						<li>
							<a href="how_to_contribute.html" title="How To Contribute">How To Contribute </a>
						</li>
						<li>
							<a href="adding_a_module.html" title="Adding a Module">Adding a Module </a>
						</li>
						<li>
							<a href="project-info.html" title="Project Information">Project Information </a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</footer>
		
	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2013-2014. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 0.14.0. </span><span class="publishDate">Last Published: 2014-05-13. </span></p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->

	<!-- Fallback jQuery loading from Google CDN:
	     http://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go -->
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script type="text/javascript">
		if (typeof jQuery == 'undefined')
		{
			document.write(unescape("%3Cscript src='./js/jquery-1.8.3.min.js' type='text/javascript'%3E%3C/script%3E"));
		}
	</script>
	
	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.js"></script>
	<script src="./js/jquery.smooth-scroll.min.js"></script>
	<!-- back button support for smooth scroll -->
	<script src="./js/jquery.ba-bbq.min.js"></script>
	<script src="http://yandex.st/highlightjs/7.3/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>
	
	</body>
</html>
